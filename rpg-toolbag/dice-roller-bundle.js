(function(){"use strict";var __webpack_modules__={892:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{w:function(){return Component}});class RpgData{SUM_LIST=[];D_LIST=[];historyLines=[];$MINIMUM=null;set MINIMUM(t){this.$MINIMUM=t,this.save()}get MINIMUM(){return this.$MINIMUM}$FLAT=null;set FLAT(t){this.$FLAT=t,this.save()}get FLAT(){return this.$FLAT}$SKILL=null;set SKILL(t){this.$SKILL=t,this.save()}get SKILL(){return this.$SKILL}$TABSVIEW=null;set TABSVIEW(t){this.$TABSVIEW=t,this.save()}get TABSVIEW(){return this.$TABSVIEW}$W40MODE=null;set W40MODE(t){this.$W40MODE=t,this.save()}get W40MODE(){return this.$W40MODE}$SUM=null;set SUM(t){this.$SUM=t,this.save()}get SUM(){return this.$SUM}$DEGREESV_MIN=null;set DEGREESV_MIN(t){this.$DEGREESV_MIN=t,this.save()}get DEGREESV_MIN(){return this.$DEGREESV_MIN}$REROLLLOWEST=null;set REROLLLOWEST(t){this.$REROLLLOWEST=t,this.save()}get REROLLLOWEST(){return this.$REROLLLOWEST}$SHOWFORMULA=null;set SHOWFORMULA(t){this.$SHOWFORMULA=t,this.save()}get SHOWFORMULA(){return this.$SHOWFORMULA}$LASMASTERY=null;set LASMASTERY(t){this.$LASMASTERY=t,this.save()}get LASMASTERY(){return this.$LASMASTERY}save(){localStorage.setItem("rggdata",JSON.stringify(this))}}const rpgData=new RpgData,SUCCESSTEXT="SUCCESS",FAILTEXT="FAIL";class Component{$ROLL;$SKILL;$MINIMUM;$FLAT;$TABSVIEW;$REROLLLOWEST;$FORMULA;$SHOWFORMULA;$LASMASTERY;$DEGREESV_MIN;$RESULT;$ACCURATE_ROLL;$LAST_HISTORY;$FULL_HISTORY;$FORMULAPARENT;$TABSVIEW_PARENT;$W40MODE;$MINIMUMVal;$FLATVal;$SUM;$FORMULA_RESULT;$DEGREESV;init(){this.$ROLL=$("#ROLL"),this.$SKILL=$("#SKILL"),this.$MINIMUM=$("#MINIMUM"),this.$FLAT=$("#FLAT"),this.$TABSVIEW=$("#TABSVIEW"),this.$REROLLLOWEST=$("#REROLLLOWEST"),this.$FORMULA=$("#FORMULA"),this.$SHOWFORMULA=$("#SHOWFORMULA"),this.$LASMASTERY=$("#LASMASTERY"),this.$DEGREESV_MIN=$("#DEGREESV_MIN"),this.$RESULT=$("#RESULT"),this.$ACCURATE_ROLL=$("#ACCURATE_ROLL"),this.$LAST_HISTORY=$("#LAST_HISTORY"),this.$FULL_HISTORY=$("#FULL_HISTORY"),this.$FORMULAPARENT=$("#FORMULAPARENT"),this.$TABSVIEW_PARENT=$("#TABSVIEW_PARENT"),this.$W40MODE=$("#W40MODE"),this.$MINIMUMVal=$("#MINIMUMVal"),this.$FLATVal=$("#FLATVal"),this.$SUM=$("#SUM"),this.$FORMULA_RESULT=$("#FORMULA_RESULT"),this.$DEGREESV=$("#DEGREESV");const t=localStorage.getItem("rggdata");if(t){const a=JSON.parse(t);rpgData.SUM_LIST=a.SUM_LIST,rpgData.D_LIST=a.D_LIST,rpgData.$MINIMUM=a.$MINIMUM,rpgData.$FLAT=a.$FLAT,rpgData.$SKILL=a.$SKILL,rpgData.$TABSVIEW=a.$TABSVIEW,rpgData.$W40MODE=a.$W40MODE,rpgData.$SUM=a.$SUM,rpgData.$DEGREESV_MIN=a.$DEGREESV_MIN,rpgData.$REROLLLOWEST=a.$REROLLLOWEST,rpgData.$SHOWFORMULA=a.$SHOWFORMULA,rpgData.$LASMASTERY=a.$LASMASTERY,rpgData.historyLines=a.historyLines,rpgData.historyLines&&rpgData.historyLines.length>0&&(this.$LAST_HISTORY.html(rpgData.historyLines[rpgData.historyLines.length-1]),rpgData.historyLines.forEach((t=>{this.$FULL_HISTORY.prepend("<li class='list-group-item' data-type='array-item'>"+t+"</li>")})))}null!=rpgData.MINIMUM&&+rpgData.MINIMUM>0&&(this.$MINIMUM.val(rpgData.MINIMUM),this.$MINIMUM.attr("data-slider-value",rpgData.MINIMUM),this.$MINIMUMVal.text(rpgData.MINIMUM)),this.$MINIMUM.slider(),this.$MINIMUM.on("slide",(t=>{this.$MINIMUMVal.text(t.value)})),null!=rpgData.FLAT&&+rpgData.FLAT>0&&(this.$FLAT.val(rpgData.FLAT),this.$FLAT.attr("data-slider-value",rpgData.FLAT),this.$FLATVal.text(rpgData.FLAT)),this.$FLAT.slider(),this.$FLAT.on("slide",(t=>{this.$FLATVal.text(t.value)})),null!=rpgData.SKILL&&this.$SKILL.val(rpgData.SKILL),null!=rpgData.TABSVIEW&&"true"==rpgData.TABSVIEW?(this.$TABSVIEW.prop("checked",!0),this.$TABSVIEW_PARENT.removeClass("tabsviewoff")):(this.$TABSVIEW.prop("checked",!1),this.$TABSVIEW_PARENT.addClass("tabsviewoff")),null!=rpgData.W40MODE&&"true"==rpgData.W40MODE?(this.$W40MODE.prop("checked",!0),this.$TABSVIEW_PARENT.addClass("w40kmode")):(this.$W40MODE.prop("checked",!1),this.$TABSVIEW_PARENT.removeClass("w40kmode")),this.$SUM.prop("checked",null!=rpgData.SUM&&"true"==rpgData.SUM),this.$DEGREESV_MIN.prop("checked",null!=rpgData.DEGREESV_MIN&&"true"==rpgData.DEGREESV_MIN),this.$REROLLLOWEST.prop("checked",null!=rpgData.REROLLLOWEST&&"true"==rpgData.REROLLLOWEST),null!=rpgData.SHOWFORMULA&&"true"==rpgData.SHOWFORMULA?(this.$SHOWFORMULA.prop("checked",!0),this.$FORMULAPARENT.css({display:"inherit"})):(this.$SHOWFORMULA.prop("checked",!1),this.$FORMULAPARENT.css({display:"none"})),this.$LASMASTERY.prop("checked",null!=rpgData.$LASMASTERY&&"true"==rpgData.$LASMASTERY),this.$SHOWFORMULA.change((t=>{rpgData.SHOWFORMULA=this.$SHOWFORMULA.prop("checked")?"true":"false",this.$SHOWFORMULA.prop("checked")?this.$FORMULAPARENT.css({display:"inherit"}):this.$FORMULAPARENT.css({display:"none"})})),this.$FLAT.change((t=>{const a=this.$FLAT.val();a&&(rpgData.FLAT=a.toString())})),this.$MINIMUM.change((t=>{const a=this.$MINIMUM.val();a&&(rpgData.MINIMUM=a.toString())})),this.$REROLLLOWEST.change((t=>{rpgData.REROLLLOWEST=this.$REROLLLOWEST.prop("checked")?"true":"false"})),this.$LASMASTERY.change((t=>{rpgData.$LASMASTERY=this.$LASMASTERY.prop("checked")?"true":"false"})),this.$SUM.change((t=>{rpgData.SUM=this.$SUM.prop("checked")?"true":"false"})),this.$DEGREESV_MIN.change((t=>{rpgData.DEGREESV_MIN=this.$DEGREESV_MIN.prop("checked")?"true":"false"})),this.$TABSVIEW.change((t=>{this.$TABSVIEW_PARENT.toggleClass("tabsviewoff"),rpgData.TABSVIEW=this.$TABSVIEW.prop("checked")?"true":"false"})),this.$W40MODE.change((t=>{this.$TABSVIEW_PARENT.toggleClass("w40kmode"),rpgData.W40MODE=this.$W40MODE.prop("checked")?"true":"false"})),$('[data-toggle="popover"]').popover({trigger:"focus",html:!0}),$("#clearLatest").confirmation({rootSelector:"#clearLatest",onConfirm:()=>{this.clearLatest()}}),$("#clearSum").confirmation({rootSelector:"#clearSum",onConfirm:()=>{this.clearSum()}}),$("#clearHistory").confirmation({rootSelector:"#clearHistory",onConfirm:()=>{this.clearHistory()}}),this.$SKILL.change((t=>{this.change(),this.saveSkill()})),this.$SKILL.keyup((t=>{this.change(),this.saveSkill()})),this.$ROLL.change((t=>{const a=this.$ROLL.val();a&&this.rollSet100(Number(a))})),this.$ROLL.keyup((t=>{if(null==t||"Enter"!==t.key&&13!==t.keyCode)this.change();else{const t=this.$ROLL.val();t&&this.rollSet100(Number(t))}})),this.$FORMULA.change((t=>{this.calcFormula()})),this.$FORMULA.keyup((t=>{this.calcFormula()})),document.getElementById("rollRandom100")?.addEventListener("click",(t=>{this.rollRandom100(t)})),document.getElementById("saveFormulaResult")?.addEventListener("click",(t=>{this.saveFormulaResult()})),document.getElementById("ACCURATE_ROLL")?.addEventListener("click",(t=>{this.rollRandomAccurate(10,"i10")})),$("[rollRandom]").click((t=>{console.log("event",t);const a=t.target;console.log("eventTarget",a);const e=a.getAttribute("rollRandom");if(console.log("max",e),e){const a=t.originalEvent;console.log("originalEvent",a),a&&this.rollRandom(a,Number(e),"i"+e)}}))}saveSkill(){const t=this.$SKILL.val();t&&(rpgData.SKILL=t.toString())}calcFormula(){try{let FORMULA=this.$FORMULA.val();if(FORMULA){console.log(FORMULA),FORMULA=FORMULA.toString().replace("x","*").replace(":","/").replace("ร","*").replace("รท","/").replace("+","+").replace(",","."),console.log(FORMULA);const FORMULA_EVAL=eval(FORMULA);console.log(FORMULA_EVAL),this.$FORMULA_RESULT.text(FORMULA_EVAL)}}catch(t){console.log(t),this.$FORMULA_RESULT.text("?")}}saveFormulaResult(){this.$SKILL.val(this.$FORMULA_RESULT.text()),this.saveSkill()}clearSum(){rpgData.SUM_LIST.splice(0,rpgData.SUM_LIST.length),rpgData.D_LIST.splice(0,rpgData.D_LIST.length),rpgData.historyLines.splice(0,rpgData.historyLines.length),rpgData.save()}clearHistory(){this.clearSum(),this.$FULL_HISTORY.html("\x3c!-- --\x3e")}clearLatest(){const t=$("#FULL_HISTORY li:first-of-type");console.log(t.attr("data-type")),"array-item"==t.attr("data-type")&&(console.log("last array item removed"),rpgData.SUM_LIST.pop(),rpgData.D_LIST.pop(),rpgData.historyLines.pop(),rpgData.save()),t.remove()}rollRandomAccurate(t,a){const e=this.$ACCURATE_ROLL.attr("accurate-dice");console.log("accurate-dice: "+e);for(let s=0;s<Number(e);s++)this.rollRandom(null,t,a)}rollRandom(t,a,e){let s=1;t&&(console.log("SHIFT:"+t.shiftKey),console.log("CTRL:"+t.ctrlKey),t.ctrlKey&&t.shiftKey?s=20:t.ctrlKey?s=10:t.shiftKey&&(s=5));for(let t=0;t<s;t++)this._rollRandom(a,e)}_rollRandom(t,a){const e=this.getRandomInt(t)+1;document.getElementById(a).value=e.toString(),this.$SUM.prop("checked")||this.clearSum(),rpgData.SUM_LIST.push(e),rpgData.D_LIST.push(t),rpgData.save();const s=this.checkSameValues(rpgData.D_LIST),r=s&&10==rpgData.D_LIST[0]&&this.$RESULT.val()==SUCCESSTEXT&&this.$W40MODE.prop("checked"),i=r&&this.$DEGREESV_MIN.prop("checked"),l=this.$REROLLLOWEST.prop("checked"),o=r&&this.$LASMASTERY.prop("checked"),L=Number(this.$MINIMUM.val())>0,S=Number(this.$FLAT.val())>0;let h=0,n="";const c=[...rpgData.SUM_LIST];if(l){let t=9999999,a=9999999;c.forEach(((e,s,r)=>{e<t&&(t=e,a=s)})),c[a]=-1}if(L){const t=Number(this.$MINIMUM.val());c.forEach(((a,e,s)=>{a<t&&-1!=a&&(c[e]=t)}))}if(i){let t=9999999,a=9999999;c.forEach(((e,s,r)=>{e<t&&-1!=e&&(t=e,a=s)}));const e=Math.min(10,Number(this.$DEGREESV.val()));t<e&&(c[a]=e)}if(n="",h=0,c.forEach(((t,a,e)=>{a>0&&(n+=" + "),-1==t?n=s?n+"<span class='cross'>"+rpgData.SUM_LIST[a]+"</span>":n+"<span class='cross'>"+rpgData.SUM_LIST[a]+"/[D"+rpgData.D_LIST[a]+"]</span>":(rpgData.SUM_LIST[a]!=t?n=s?n+rpgData.SUM_LIST[a]+"&#x21E8;"+t:n+rpgData.SUM_LIST[a]+"&#x21E8;"+t+"/[D"+rpgData.D_LIST[a]+"]":s?n+=t:n=n+t+"/[D"+rpgData.D_LIST[a]+"]",this.$W40MODE.prop("checked")?0==a&&10==rpgData.SUM_LIST[a]&&(n+="<i style='margin-left:2px;' class='fas fa-meteor text-warning'></i>"):20==rpgData.SUM_LIST[a]&&20==rpgData.D_LIST[a]&&(n+="<i style='margin-left:2px;' class='fas fa-meteor text-warning'></i>"),h+=t)})),o){const t=Math.floor((Number(this.$DEGREESV.val())-1)/2);t>0&&(h+=t)}if(S&&(h+=Number(this.$FLAT.val())),n="<span style='width:35px;' class='badge badge-pill badge-info'>"+h+"</span> = &Sigma;[#"+rpgData.SUM_LIST.length+"]("+n+")",s&&(n=n+"/[D"+rpgData.D_LIST[0]+"]"),S&&(n=n+" + "+Number(this.$FLAT.val())+" (Flat Bonus)"),o){const t=Math.floor((Number(this.$DEGREESV.val())-1)/2);t>0&&(n=n+" + "+t+" (Las Mastery)")}const p="<span style='display:inline;color:inherit;font-family:monospace;'>",E=(new Date).toLocaleTimeString(this.getNavigatorLanguages()[0])+" &#8669; roll "+p+"<span style='width:35px;' class='badge badge-pill badge-info'>"+(""+e).padStart(3," ")+"</span></span> "+p+(" op D"+t).padStart(6," ")+" &#8669; </span> "+n;this.$LAST_HISTORY.html(E),this.$FULL_HISTORY.prepend("<li class='list-group-item' data-type='array-item'>"+E+"</li>"),rpgData.historyLines.push(E),rpgData.save()}checkSameValues(t){return 1==new Set(t).size}rollRandom100(t){let a;if(console.log("SHIFT:"+t.shiftKey),console.log("CTRL:"+t.ctrlKey),t.ctrlKey&&t.shiftKey)for(a=0;a<20;a++)this._rollRandom100();else if(t.ctrlKey)for(a=0;a<10;a++)this._rollRandom100();else if(t.shiftKey)for(a=0;a<5;a++)this._rollRandom100();else this._rollRandom100()}_rollRandom100(){const t=this.getRandomInt(100)+1;this.$ROLL.val(t),this.rollSet100(t)}rollSet100(t){this.clearSum(),this.change();const a=Number(this.$SKILL.val()),e=this.$RESULT.val()==SUCCESSTEXT,s=this.$DEGREESV.val(),r="<span style='display:inline;color:inherit;font-family:monospace;'>",i=(new Date).toLocaleTimeString(this.getNavigatorLanguages()[0])+" &#8669; roll <span style='width:35px;' class='badge badge-pill badge-info'>"+r+"</span>"+(""+t).padStart(3," ")+"</span> op skill "+r+(""+a).padStart(3," ")+"</span> &#8669; "+(e?" <span style='width:65px;' class='badge badge-pill badge-success'>"+SUCCESSTEXT+"</span>":"<span style='width:65px;' class='badge badge-pill badge-warning'>"+FAILTEXT+"</span>")+" met <span style='width:35px;' class='badge badge-pill badge-dark'>"+s+"</span> degrees";this.$LAST_HISTORY.html(i),this.$FULL_HISTORY.prepend("<li class='list-group-item' data-type='roll-item'>"+i+"</li>")}getRandomInt(t){return Math.floor(Math.random()*Math.floor(t))}change(){const t=Number(this.$SKILL.val()),a=Number(this.$ROLL.val());let e,s;if(console.log("ROLL<=SKILL :: "+a+"<="+t+" :: "+(a<=t)),a<=t){const r=(t-a)/10;console.log("diff="+r),e=1+Math.floor(r),s=!0,console.log(SUCCESSTEXT+" +"+e+" DEGREESV")}else{const r=(a-t-1)/10;console.log("diff="+r),e=1+Math.floor(r),s=!1,console.log(FAILTEXT+" -"+e+" DEGREESV")}if(this.$RESULT.val(s?SUCCESSTEXT:FAILTEXT),s){this.$RESULT.addClass("bg-success"),this.$RESULT.removeClass("bg-warning"),this.$RESULT.addClass("text-white");const t=Math.min(2,Math.floor(e/2));console.log("ACCURATE="+t),this.$ACCURATE_ROLL.html("+"+t+"D"),this.$ACCURATE_ROLL.attr("accurate-dice",1+t)}else this.$RESULT.removeClass("bg-success"),this.$RESULT.addClass("bg-warning"),this.$RESULT.addClass("text-white"),this.$ACCURATE_ROLL.html("-"),this.$ACCURATE_ROLL.attr("accurate-dice",0);this.$DEGREESV.val(e)}getNavigatorLanguages(){return navigator.language.split("-")}}}},__webpack_module_cache__={};function __webpack_require__(t){var a=__webpack_module_cache__[t];if(void 0!==a)return a.exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=function(t,a){for(var e in a)__webpack_require__.o(a,e)&&!__webpack_require__.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:a[e]})},__webpack_require__.o=function(t,a){return Object.prototype.hasOwnProperty.call(t,a)};var __webpack_exports__={};(new(__webpack_require__(892).w)).init()})();
//# sourceMappingURL=dice-roller-bundle.js.map