(function(){"use strict";var __webpack_modules__={892:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{w:function(){return Component}});class RpgData{SUM_LIST=[];D_LIST=[];DATA={};historyLines=[];save(){localStorage.setItem("rggdata",JSON.stringify(this)),console.log("RpgData.save: "+JSON.stringify(this))}}const rpgData=new RpgData,SUCCESSTEXT="SUCCESS",FAILTEXT="FAIL";class Component{window_localStorage_getItem(e){return rpgData.DATA[e]}window_localStorage_setItem(e,t){rpgData.DATA[e]=t,rpgData.save()}init(){{const e=localStorage.getItem("rggdata");if(e){console.log("RpgData.init: "+e);const t=JSON.parse(e);rpgData.SUM_LIST=t.SUM_LIST,rpgData.D_LIST=t.D_LIST,rpgData.DATA=t.DATA,rpgData.historyLines=t.historyLines,rpgData.historyLines.length>0&&($("#LAST_HISTORY").html(rpgData.historyLines[rpgData.historyLines.length-1]),rpgData.historyLines.forEach((e=>{$("#FULL_HISTORY").prepend("<li class='list-group-item' data-type='array-item'>"+e+"</li>")})))}}{const e=this.window_localStorage_getItem("MINIMUM");null!=e&&+e>0&&($("#MINIMUM").val(e),$("#MINIMUM").attr("data-slider-value",e),$("#MINIMUMVal").text(e)),$("#MINIMUM").slider(),$("#MINIMUM").on("slide",(e=>{$("#MINIMUMVal").text(e.value)}))}{const e=this.window_localStorage_getItem("FLAT");null!=e&&+e>0&&($("#FLAT").val(e),$("#FLAT").attr("data-slider-value",e),$("#FLATVal").text(e)),$("#FLAT").slider(),$("#FLAT").on("slide",(e=>{$("#FLATVal").text(e.value)}))}{const e=this.window_localStorage_getItem("SKILL");null!=e&&(document.getElementById("SKILL").value=e,console.log("restoreSkill:"+e))}{const e=this.window_localStorage_getItem("TABSVIEW");null!=e&&"true"==e?(console.log("restore TABSVIEW: TRUE"),$("#TABSVIEW").prop("checked",!0),$("#TABSVIEW_PARENT").removeClass("tabsviewoff")):(console.log("restore TABSVIEW: FALSE"),$("#TABSVIEW").prop("checked",!1),$("#TABSVIEW_PARENT").addClass("tabsviewoff"))}{const e=this.window_localStorage_getItem("W40MODE");null!=e&&"true"==e?($("#W40MODE").prop("checked",!0),$("#TABSVIEW_PARENT").addClass("w40kmode")):($("#W40MODE").prop("checked",!1),$("#TABSVIEW_PARENT").removeClass("w40kmode"))}{const e=this.window_localStorage_getItem("SUM");null!=e&&"true"==e?$("#SUM").prop("checked",!0):$("#SUM").prop("checked",!1)}{const e=this.window_localStorage_getItem("DEGREESV_MIN");null!=e&&"true"==e?$("#DEGREESV_MIN").prop("checked",!0):$("#DEGREESV_MIN").prop("checked",!1)}{const e=this.window_localStorage_getItem("REROLLLOWEST");null!=e&&"true"==e?$("#REROLLLOWEST").prop("checked",!0):$("#REROLLLOWEST").prop("checked",!1)}{const e=this.window_localStorage_getItem("SHOWFORMULA");null!=e&&"true"==e?($("#SHOWFORMULA").prop("checked",!0),$("#FORMULAPARENT").css({display:"inherit"})):($("#SHOWFORMULA").prop("checked",!1),$("#FORMULAPARENT").css({display:"none"}))}{const e=this.window_localStorage_getItem("LASMASTERY");null!=e&&"true"==e?$("#LASMASTERY").prop("checked",!0):$("#LASMASTERY").prop("checked",!1)}$("#SHOWFORMULA").change((e=>{this.window_localStorage_setItem("SHOWFORMULA",$("#SHOWFORMULA").prop("checked")?"true":"false"),this.window_localStorage_getItem("SHOWFORMULA"),$("#SHOWFORMULA").prop("checked")?(console.log("set SHOWFORMULA: TRUE"),$("#FORMULAPARENT").css({display:"inherit"})):(console.log("set SHOWFORMULA: FALSE"),$("#FORMULAPARENT").css({display:"none"}))})),$("#FLAT").change((e=>{const t=$("#FLAT").val();t&&this.window_localStorage_setItem("FLAT",t.toString());const a=this.window_localStorage_getItem("FLAT");console.log("set FLAT:"+a)})),$("#MINIMUM").change((e=>{const t=$("#MINIMUM").val();t&&this.window_localStorage_setItem("MINIMUM",t.toString());const a=this.window_localStorage_getItem("MINIMUM");console.log("set MINIMUM:"+a)})),$("#REROLLLOWEST").change((e=>{this.window_localStorage_setItem("REROLLLOWEST",$("#REROLLLOWEST").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("REROLLLOWEST");console.log("set REROLLLOWEST:"+t)})),$("#LASMASTERY").change((e=>{this.window_localStorage_setItem("LASMASTERY",$("#LASMASTERY").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("LASMASTERY");console.log("set LASMASTERY:"+t)})),$("#SUM").change((e=>{this.window_localStorage_setItem("SUM",$("#SUM").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("SUM");console.log("set SUM:"+t)})),$("#DEGREESV_MIN").change((e=>{this.window_localStorage_setItem("DEGREESV_MIN",$("#DEGREESV_MIN").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("DEGREESV_MIN");console.log("set DEGREESV_MIN:"+t)})),$("#TABSVIEW").change((e=>{$("#TABSVIEW_PARENT").toggleClass("tabsviewoff"),this.window_localStorage_setItem("TABSVIEW",$("#TABSVIEW").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("TABSVIEW");console.log("set TABSVIEW:"+t)})),$("#W40MODE").change((e=>{$("#TABSVIEW_PARENT").toggleClass("w40kmode"),this.window_localStorage_setItem("W40MODE",$("#W40MODE").prop("checked")?"true":"false");const t=this.window_localStorage_getItem("W40MODE");console.log("set W40MODE:"+t)})),$('[data-toggle="popover"]').popover({trigger:"focus",html:!0}),$("#clearLatest").confirmation({rootSelector:"#clearLatest",onConfirm:()=>{this.clearLatest()}}),$("#clearSum").confirmation({rootSelector:"#clearSum",onConfirm:()=>{this.clearSum()}}),$("#clearHistory").confirmation({rootSelector:"#clearHistory",onConfirm:()=>{this.clearHistory()}});{const e=this;$("#SKILL").change((t=>{e.change(),e.saveSkill()})),$("#SKILL").keyup((t=>{e.change(),e.saveSkill()})),$("#ROLL").change((t=>{const a=$("#ROLL").val();a&&e.rollSet100(Number(a))})),$("#ROLL").keyup((t=>{if(null==t||"Enter"!==t.key&&13!==t.keyCode)e.change();else{const t=$("#ROLL").val();t&&e.rollSet100(Number(t))}})),$("#FORMULA").change((t=>{e.calcFormula()})),$("#FORMULA").keyup((t=>{e.calcFormula()}))}{let e=0,t=0;for(e=0;e<1e4;e++)t+=this.getRandomInt(100)+1;console.log("test "+t/1e4)}document.getElementById("rollRandom100")?.addEventListener("click",(e=>{this.rollRandom100(e)})),document.getElementById("saveFormulaResult")?.addEventListener("click",(e=>{this.saveFormulaResult()})),document.getElementById("ACCURATE_ROLL")?.addEventListener("click",(e=>{this.rollRandomAccurate(10,"i10")})),$("[rollRandom]").click((e=>{console.log("event",e);const t=e.target;console.log("eventTarget",t);const a=t.getAttribute("rollRandom");if(console.log("max",a),a){const t=e.originalEvent;console.log("originalEvent",t),t&&this.rollRandom(t,Number(a),"i"+a)}}))}saveSkill(){const e=$("#SKILL").val();e&&(this.window_localStorage_setItem("SKILL",e.toString()),console.log("saveSkill:"+e))}calcFormula(){try{let FORMULA=$("#FORMULA").val();if(FORMULA){console.log(FORMULA),FORMULA=FORMULA.toString().replace("x","*").replace(":","/").replace("ร","*").replace("รท","/").replace("+","+").replace(",","."),console.log(FORMULA);const FORMULA_EVAL=eval(FORMULA);console.log(FORMULA_EVAL),$("#FORMULA_RESULT").text(FORMULA_EVAL)}}catch(e){console.log(e),$("#FORMULA_RESULT").text("?")}}saveFormulaResult(){$("#SKILL").val($("#FORMULA_RESULT").text()),this.saveSkill()}clearSum(){rpgData.SUM_LIST.splice(0,rpgData.SUM_LIST.length),rpgData.D_LIST.splice(0,rpgData.D_LIST.length),rpgData.historyLines.splice(0,rpgData.historyLines.length),rpgData.save()}clearHistory(){this.clearSum(),$("#FULL_HISTORY").html("\x3c!-- --\x3e")}clearLatest(){console.log($("#FULL_HISTORY li:first-of-type").attr("data-type")),"array-item"==$("#FULL_HISTORY li:first-of-type").attr("data-type")&&(console.log("last array item removed"),rpgData.SUM_LIST.pop(),rpgData.D_LIST.pop(),rpgData.historyLines.pop(),rpgData.save()),$("#FULL_HISTORY li:first-of-type").remove()}rollRandomAccurate(e,t){const a=$("#ACCURATE_ROLL").attr("accurate-dice");console.log("accurate-dice: "+a);for(let o=0;o<Number(a);o++)this.rollRandom(null,e,t)}rollRandom(e,t,a){let o=1;e&&(console.log("SHIFT:"+e.shiftKey),console.log("CTRL:"+e.ctrlKey),e.ctrlKey&&e.shiftKey?o=20:e.ctrlKey?o=10:e.shiftKey&&(o=5));for(let e=0;e<o;e++)this._rollRandom(t,a)}_rollRandom(e,t){const a=this.getRandomInt(e)+1;document.getElementById(t).value=a.toString(),$("#SUM").prop("checked")||this.clearSum(),rpgData.SUM_LIST.push(a),rpgData.D_LIST.push(e),rpgData.save();const o=this.checkSameValues(rpgData.D_LIST),l=o&&10==rpgData.D_LIST[0]&&$("#RESULT").val()==SUCCESSTEXT&&$("#W40MODE").prop("checked"),s=l&&$("#DEGREESV_MIN").prop("checked"),r=$("#REROLLLOWEST").prop("checked"),c=l&&$("#LASMASTERY").prop("checked"),n=Number($("#MINIMUM").val())>0,i=Number($("#FLAT").val())>0;console.log("SUM_LIST: "+rpgData.SUM_LIST),console.log("D_LIST: "+rpgData.D_LIST);let S=0,g="";const _=[...rpgData.SUM_LIST];if(r){let e=9999999,t=9999999;_.forEach(((a,o,l)=>{a<e&&(e=a,t=o)})),_[t]=-1,console.log("withREROLLLOWEST: "+_)}if(n){const e=Number($("#MINIMUM").val());_.forEach(((t,a,o)=>{t<e&&-1!=t&&(_[a]=e)})),console.log("withMINIMUM: "+_)}if(s){let e=9999999,t=9999999;_.forEach(((a,o,l)=>{a<e&&-1!=a&&(e=a,t=o)}));const a=Math.min(10,Number($("#DEGREESV").val()));e<a&&(_[t]=a),console.log("withDEGREESV_MIN: "+_)}if(g="",S=0,_.forEach(((e,t,a)=>{console.log("item",e,"index",t,"array",a,"rpgData.SUM_LIST[index]",rpgData.SUM_LIST[t],"CONVERTED_LIST[index]",_[t],"rpgData.D_LIST[index]",rpgData.D_LIST[t]),t>0&&(g+=" + "),-1==e?g=o?g+"<span class='cross'>"+rpgData.SUM_LIST[t]+"</span>":g+"<span class='cross'>"+rpgData.SUM_LIST[t]+"/[D"+rpgData.D_LIST[t]+"]</span>":(rpgData.SUM_LIST[t]!=e?g=o?g+rpgData.SUM_LIST[t]+"&#x21E8;"+e:g+rpgData.SUM_LIST[t]+"&#x21E8;"+e+"/[D"+rpgData.D_LIST[t]+"]":o?g+=e:g=g+e+"/[D"+rpgData.D_LIST[t]+"]",$("#W40MODE").prop("checked")?0==t&&10==rpgData.SUM_LIST[t]&&(g+="<i style='margin-left:2px;' class='fas fa-meteor text-warning'></i>"):20==rpgData.SUM_LIST[t]&&20==rpgData.D_LIST[t]&&(g+="<i style='margin-left:2px;' class='fas fa-meteor text-warning'></i>"),S+=e)})),c){const e=Math.floor((Number($("#DEGREESV").val())-1)/2);e>0&&(S+=e)}if(i&&(S+=Number($("#FLAT").val())),g="<span style='width:35px;' class='badge badge-pill badge-info'>"+S+"</span> = &Sigma;[#"+rpgData.SUM_LIST.length+"]("+g+")",o&&(g=g+"/[D"+rpgData.D_LIST[0]+"]"),i&&(g=g+" + "+Number($("#FLAT").val())+" (Flat Bonus)"),c){const e=Math.floor((Number($("#DEGREESV").val())-1)/2);e>0&&(g=g+" + "+e+" (Las Mastery)")}const p="<span style='display:inline;color:inherit;font-family:monospace;'>",L=(new Date).toLocaleTimeString(this.getNavigatorLanguages()[0])+" &#8669; roll "+p+"<span style='width:35px;' class='badge badge-pill badge-info'>"+(""+a).padStart(3," ")+"</span></span> "+p+(" op D"+e).padStart(6," ")+" &#8669; </span> "+g;$("#LAST_HISTORY").html(L),$("#FULL_HISTORY").prepend("<li class='list-group-item' data-type='array-item'>"+L+"</li>"),rpgData.historyLines.push(L),rpgData.save()}checkSameValues(e){return 1==new Set(e).size}rollRandom100(e){let t;if(console.log("SHIFT:"+e.shiftKey),console.log("CTRL:"+e.ctrlKey),e.ctrlKey&&e.shiftKey)for(t=0;t<20;t++)this._rollRandom100();else if(e.ctrlKey)for(t=0;t<10;t++)this._rollRandom100();else if(e.shiftKey)for(t=0;t<5;t++)this._rollRandom100();else this._rollRandom100()}_rollRandom100(){const e=this.getRandomInt(100)+1;$("#ROLL").val(e),this.rollSet100(e)}rollSet100(e){this.clearSum(),this.change();const t=Number($("#SKILL").val()),a=$("#RESULT").val()==SUCCESSTEXT,o=$("#DEGREESV").val(),l="<span style='display:inline;color:inherit;font-family:monospace;'>",s=(new Date).toLocaleTimeString(this.getNavigatorLanguages()[0])+" &#8669; roll <span style='width:35px;' class='badge badge-pill badge-info'>"+l+"</span>"+(""+e).padStart(3," ")+"</span> op skill "+l+(""+t).padStart(3," ")+"</span> &#8669; "+(a?" <span style='width:65px;' class='badge badge-pill badge-success'>"+SUCCESSTEXT+"</span>":"<span style='width:65px;' class='badge badge-pill badge-warning'>"+FAILTEXT+"</span>")+" met <span style='width:35px;' class='badge badge-pill badge-dark'>"+o+"</span> degrees";$("#LAST_HISTORY").html(s),$("#FULL_HISTORY").prepend("<li class='list-group-item' data-type='roll-item'>"+s+"</li>")}getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}change(){const e=Number($("#SKILL").val()),t=Number($("#ROLL").val());let a,o;if(console.log("ROLL<=SKILL :: "+t+"<="+e+" :: "+(t<=e)),t<=e){const l=(e-t)/10;console.log("diff="+l),a=1+Math.floor(l),o=!0,console.log(SUCCESSTEXT+" +"+a+" DEGREESV")}else{const l=(t-e-1)/10;console.log("diff="+l),a=1+Math.floor(l),o=!1,console.log(FAILTEXT+" -"+a+" DEGREESV")}if($("#RESULT").val(o?SUCCESSTEXT:FAILTEXT),o){$("#RESULT").addClass("bg-success"),$("#RESULT").removeClass("bg-warning"),$("#RESULT").addClass("text-white");const e=Math.min(2,Math.floor(a/2));console.log("ACCURATE="+e),$("#ACCURATE_ROLL").html("+"+e+"D"),$("#ACCURATE_ROLL").attr("accurate-dice",1+e)}else $("#RESULT").removeClass("bg-success"),$("#RESULT").addClass("bg-warning"),$("#RESULT").addClass("text-white"),$("#ACCURATE_ROLL").html("-"),$("#ACCURATE_ROLL").attr("accurate-dice",0);$("#DEGREESV").val(a)}getNavigatorLanguages(){return console.log(navigator.language),navigator.language.split("-")}}}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](a,a.exports,__webpack_require__),a.exports}__webpack_require__.d=function(e,t){for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var __webpack_exports__={};(new(__webpack_require__(892).w)).init()})();
//# sourceMappingURL=dice-roller-bundle.js.map