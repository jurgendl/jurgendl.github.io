!function(){"use strict";function e(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}const t=4294967296,s=[4294967295,-4294967296],n=[0,-0x8000000000000000],r=[0,0],o=[1,0];function i(e,t){return l(e[0]+t[0],e[1]+t[1])}function a(e){var t=[];return t[e-1]=void 0,t}function c(e,s){return n=~~Math.max(Math.min(e[1]/t,2147483647),-2147483648)&~~Math.max(Math.min(s[1]/t,2147483647),-2147483648),r=m(e)&m(s),o=r,r<0&&(o+=t),[o,n*t];var n,r,o}function d(e,t){var s,n;return e[0]==t[0]&&e[1]==t[1]?0:(s=e[1]<0,n=t[1]<0,s&&!n?-1:!s&&n?1:g(e,t)[1]<0?-1:1)}function l(e,s){var n,r;for(e%=0x10000000000000000,s=(s%=0x10000000000000000)-(n=s%t)+(r=Math.floor(e/t)*t),e=e-r+n;e<0;)e+=t,s-=t;for(;e>4294967295;)e-=t,s+=t;for(s%=0x10000000000000000;s>0x7fffffff00000000;)s-=0x10000000000000000;for(;s<-0x8000000000000000;)s+=0x10000000000000000;return[e,s]}function u(e,t){return e[0]==t[0]&&e[1]==t[1]}function _(e){return e>=0?[e,0]:[e+t,-4294967296]}function m(e){return e[0]>=2147483648?~~Math.max(Math.min(e[0]-t,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function h(e){return e<=30?1<<e:h(30)*h(e-30)}function p(e,s){var o,i,a,c;if(s&=63,u(e,n))return s?r:e;if(e[1]<0)throw new Error("Neg");return c=h(s),i=e[1]*c%0x10000000000000000,(i+=o=(a=e[0]*c)-a%t)>=0x8000000000000000&&(i-=0x10000000000000000),[a-=o,i]}function f(e,t){var s;return s=h(t&=63),l(Math.floor(e[0]/s),e[1]/s)}function g(e,t){return l(e[0]-t[0],e[1]-t[1])}function v(e,t){return e.buf=t,e.pos=0,e.count=t.length,e}function P(e){return e.pos>=e.count?-1:255&e.buf[e.pos++]}function B(e,t,s,n){return e.pos>=e.count?-1:(n=Math.min(n,e.count-e.pos),w(e.buf,e.pos,t,s,n),e.pos+=n,n)}function b(e){return e.buf=a(32),e.count=0,e}function k(e){var t=e.buf;return t.length=e.count,t}function S(e,t){e.buf[e.count++]=t<<24>>24}function E(e,t,s,n){w(t,s,e.buf,e.count,n),e.count+=n}function w(e,t,s,n,r){for(var o=0;o<r;++o)s[n+o]=e[t+o]}function y(e,t){return e._bufferBase[e._bufferOffset+e._pos+t]}function C(e,t,s,n){var r,o;for(e._streamEndWasReached&&e._pos+t+n>e._streamPos&&(n=e._streamPos-(e._pos+t)),++s,o=e._bufferOffset+e._pos+t,r=0;r<n&&e._bufferBase[o+r]==e._bufferBase[o+r-s];++r);return r}function M(e){return e._streamPos-e._pos}function L(e){var t,s;if(!e._streamEndWasReached)for(;;){if(!(s=-e._bufferOffset+e._blockSize-e._streamPos))return;if(-1==(t=B(e._stream,e._bufferBase,e._bufferOffset+e._streamPos,s)))return e._posLimit=e._streamPos,e._bufferOffset+e._posLimit>e._pointerToLastSafePosition&&(e._posLimit=e._pointerToLastSafePosition-e._bufferOffset),void(e._streamEndWasReached=1);e._streamPos+=t,e._streamPos>=e._pos+e._keepSizeAfter&&(e._posLimit=e._streamPos-e._keepSizeAfter)}}function D(e,t){e._bufferOffset+=t,e._posLimit-=t,e._pos-=t,e._streamPos-=t}var R=function(){var e,t,s,n=[];for(e=0;e<256;++e){for(s=e,t=0;t<8;++t)0!=(1&s)?s=s>>>1^-306674912:s>>>=1;n[e]=s}return n}();function x(e){var t;++e._cyclicBufferPos>=e._cyclicBufferSize&&(e._cyclicBufferPos=0),function(e){++e._pos,e._pos>e._posLimit&&(e._bufferOffset+e._pos>e._pointerToLastSafePosition&&function(e){var t,s,n;for((n=e._bufferOffset+e._pos-e._keepSizeBefore)>0&&--n,s=e._bufferOffset+e._streamPos-n,t=0;t<s;++t)e._bufferBase[t]=e._bufferBase[n+t];e._bufferOffset-=n}(e),L(e))}(e),1073741823==e._pos&&(t=e._pos-e._cyclicBufferSize,I(e._son,2*e._cyclicBufferSize,t),I(e._hash,e._hashSizeSum,t),D(e,t))}function I(e,t,s){var n,r;for(n=0;n<t;++n)(r=e[n]||0)<=s?r=0:r-=s,e[n]=r}function T(e){var t=e._pos-e._streamPos;t&&(E(e._stream,e._buffer,e._streamPos,t),e._pos>=e._windowSize&&(e._pos=0),e._streamPos=e._pos)}function A(e,t){var s=e._pos-t-1;return s<0&&(s+=e._windowSize),e._buffer[s]}function F(e){T(e),e._stream=null}function z(e){return(e-=2)<4?e:3}function O(e){return e<4?0:e<10?e-3:e-6}function H(e){if(!e.alive)throw new Error("bad state");return e.encoder?function(e){(function(e,t,s,n){var a,c,l,h,p,f,v,P,B,b,k,S,E,w,C;if(t[0]=r,s[0]=r,n[0]=1,e._inStream&&(e._matchFinder._stream=e._inStream,function(e){e._bufferOffset=0,e._pos=0,e._streamPos=0,e._streamEndWasReached=0,L(e),e._cyclicBufferPos=0,D(e,-1)}(e._matchFinder),e._needReleaseMFStream=1,e._inStream=null),!e._finished){if(e._finished=1,w=e.nowPos64,u(e.nowPos64,r)){if(!M(e._matchFinder))return void K(e,m(e.nowPos64));te(e),E=m(e.nowPos64)&e._posStateMask,Me(e._rangeEncoder,e._isMatch,(e._state<<4)+E,0),e._state=O(e._state),l=y(e._matchFinder,-e._additionalOffset),ue(le(e._literalEncoder,m(e.nowPos64),e._previousByte),e._rangeEncoder,l),e._previousByte=l,--e._additionalOffset,e.nowPos64=i(e.nowPos64,o)}if(M(e._matchFinder))for(;;){if(v=Z(e,m(e.nowPos64)),b=e.backRes,E=m(e.nowPos64)&e._posStateMask,c=(e._state<<4)+E,1==v&&-1==b)Me(e._rangeEncoder,e._isMatch,c,0),l=y(e._matchFinder,-e._additionalOffset),C=le(e._literalEncoder,m(e.nowPos64),e._previousByte),e._state<7?ue(C,e._rangeEncoder,l):(B=y(e._matchFinder,-e._repDistances[0]-1-e._additionalOffset),_e(C,e._rangeEncoder,B,l)),e._previousByte=l,e._state=O(e._state);else{if(Me(e._rangeEncoder,e._isMatch,c,1),b<4){if(Me(e._rangeEncoder,e._isRep,e._state,1),b?(Me(e._rangeEncoder,e._isRepG0,e._state,1),1==b?Me(e._rangeEncoder,e._isRepG1,e._state,0):(Me(e._rangeEncoder,e._isRepG1,e._state,1),Me(e._rangeEncoder,e._isRepG2,e._state,b-2))):(Me(e._rangeEncoder,e._isRepG0,e._state,0),Me(e._rangeEncoder,e._isRep0Long,c,1==v?0:1)),1==v?e._state=e._state<7?9:11:(ie(e._repMatchLenEncoder,e._rangeEncoder,v-2,E),e._state=e._state<7?8:11),h=e._repDistances[b],0!=b){for(f=b;f>=1;--f)e._repDistances[f]=e._repDistances[f-1];e._repDistances[0]=h}}else{for(Me(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,ie(e._lenEncoder,e._rangeEncoder,v-2,E),S=ne(b-=4),P=z(v),Pe(e._posSlotEncoder[P],e._rangeEncoder,S),S>=4&&(k=b-(a=(2|1&S)<<(p=(S>>1)-1)),S<14?Se(e._posEncoders,a-S-1,e._rangeEncoder,p,k):(Le(e._rangeEncoder,k>>4,p-4),be(e._posAlignEncoder,e._rangeEncoder,15&k),++e._alignPriceCount)),h=b,f=3;f>=1;--f)e._repDistances[f]=e._repDistances[f-1];e._repDistances[0]=h,++e._matchPriceCount}e._previousByte=y(e._matchFinder,v-1-e._additionalOffset)}if(e._additionalOffset-=v,e.nowPos64=i(e.nowPos64,_(v)),!e._additionalOffset){if(e._matchPriceCount>=128&&V(e),e._alignPriceCount>=16&&J(e),t[0]=e.nowPos64,s[0]=De(e._rangeEncoder),!M(e._matchFinder))return void K(e,m(e.nowPos64));if(d(g(e.nowPos64,w),[4096,0])>=0)return e._finished=0,void(n[0]=0)}}else K(e,m(e.nowPos64))}})(e.encoder,e.encoder.processedInSize,e.encoder.processedOutSize,e.encoder.finished),e.inBytesProcessed=e.encoder.processedInSize[0],e.encoder.finished[0]&&(function(e){se(e),e._rangeEncoder.Stream=null}(e.encoder),e.alive=0)}(e):function(e){var t=function(e){var t,s,n,r,a,c;if(c=m(e.nowPos64)&e.m_PosStateMask,we(e.m_RangeDecoder,e.m_IsMatchDecoders,(e.state<<4)+c)){if(we(e.m_RangeDecoder,e.m_IsRepDecoders,e.state))n=0,we(e.m_RangeDecoder,e.m_IsRepG0Decoders,e.state)?(we(e.m_RangeDecoder,e.m_IsRepG1Decoders,e.state)?(we(e.m_RangeDecoder,e.m_IsRepG2Decoders,e.state)?(s=e.rep3,e.rep3=e.rep2):s=e.rep2,e.rep2=e.rep1):s=e.rep1,e.rep1=e.rep0,e.rep0=s):we(e.m_RangeDecoder,e.m_IsRep0LongDecoders,(e.state<<4)+c)||(e.state=e.state<7?9:11,n=1),n||(n=W(e.m_RepLenDecoder,e.m_RangeDecoder,c)+2,e.state=e.state<7?8:11);else if(e.rep3=e.rep2,e.rep2=e.rep1,e.rep1=e.rep0,n=2+W(e.m_LenDecoder,e.m_RangeDecoder,c),e.state=e.state<7?7:10,(a=ge(e.m_PosSlotDecoder[z(n)],e.m_RangeDecoder))>=4){if(r=(a>>1)-1,e.rep0=(2|1&a)<<r,a<14)e.rep0+=function(e,t,s,n){var r,o,i=1,a=0;for(o=0;o<n;++o)r=we(s,e,t+i),i<<=1,i+=r,a|=r<<o;return a}(e.m_PosDecoders,e.rep0-a-1,e.m_RangeDecoder,r);else if(e.rep0+=function(e,t){var s,n,r=0;for(s=t;0!=s;--s)e.Range>>>=1,n=e.Code-e.Range>>>31,e.Code-=e.Range&n-1,r=r<<1|1-n,-16777216&e.Range||(e.Code=e.Code<<8|P(e.Stream),e.Range<<=8);return r}(e.m_RangeDecoder,r-4)<<4,e.rep0+=function(e,t){var s,n,r=1,o=0;for(n=0;n<e.NumBitLevels;++n)s=we(t,e.Models,r),r<<=1,r+=s,o|=s<<n;return o}(e.m_PosAlignDecoder,e.m_RangeDecoder),e.rep0<0)return-1==e.rep0?1:-1}else e.rep0=a;if(d(_(e.rep0),e.nowPos64)>=0||e.rep0>=e.m_DictionarySizeCheck)return-1;!function(e,t,s){var n=e._pos-t-1;for(n<0&&(n+=e._windowSize);0!=s;--s)n>=e._windowSize&&(n=0),e._buffer[e._pos++]=e._buffer[n++],e._pos>=e._windowSize&&T(e)}(e.m_OutWindow,e.rep0,n),e.nowPos64=i(e.nowPos64,_(n)),e.prevByte=A(e.m_OutWindow,0)}else t=function(e,t,s){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((255&s)>>>8-e.m_NumPrevBits)]}(e.m_LiteralDecoder,m(e.nowPos64),e.prevByte),e.state<7?e.prevByte=function(e,t){var s=1;do{s=s<<1|we(t,e.m_Decoders,s)}while(s<256);return s<<24>>24}(t,e.m_RangeDecoder):e.prevByte=function(e,t,s){var n,r,o=1;do{if(r=s>>7&1,s<<=1,o=o<<1|(n=we(t,e.m_Decoders,(1+r<<8)+o)),r!=n){for(;o<256;)o=o<<1|we(t,e.m_Decoders,o);break}}while(o<256);return o<<24>>24}(t,e.m_RangeDecoder,A(e.m_OutWindow,e.rep0)),function(e,t){e._buffer[e._pos++]=t,e._pos>=e._windowSize&&T(e)}(e.m_OutWindow,e.prevByte),e.state=O(e.state),e.nowPos64=i(e.nowPos64,o);return 0}(e.decoder);if(-1==t)throw new Error("corrupted input");e.inBytesProcessed=s,e.outBytesProcessed=e.decoder.nowPos64,(t||d(e.decoder.outSize,r)>=0&&d(e.decoder.nowPos64,e.decoder.outSize)>=0)&&(T(e.decoder.m_OutWindow),F(e.decoder.m_OutWindow),e.decoder.m_RangeDecoder.Stream=null,e.alive=0)}(e),e.alive}function N(e,t){for(;e.m_NumPosStates<t;++e.m_NumPosStates)e.m_LowCoder[e.m_NumPosStates]=fe({},3),e.m_MidCoder[e.m_NumPosStates]=fe({},3)}function W(e,t,s){if(!we(t,e.m_Choice,0))return ge(e.m_LowCoder[s],t);var n=8;return we(t,e.m_Choice,1)?n+=8+ge(e.m_HighCoder,t):n+=ge(e.m_MidCoder[s],t),n}function G(e){return e.m_Choice=a(2),e.m_LowCoder=a(16),e.m_MidCoder=a(16),e.m_HighCoder=fe({},8),e.m_NumPosStates=0,e}function q(e){ye(e.m_Choice);for(var t=0;t<e.m_NumPosStates;++t)ye(e.m_LowCoder[t].Models),ye(e.m_MidCoder[t].Models);ye(e.m_HighCoder.Models)}function Y(e){return e.m_Decoders=a(768),e}var j=function(){var e,t,s,n=2,r=[0,1];for(s=2;s<22;++s)for(t=1<<(s>>1)-1,e=0;e<t;++e,++n)r[n]=s<<24>>24;return r}();function U(e,t){var s,n,r,o;e._optimumEndIndex=t,r=e._optimum[t].PosPrev,n=e._optimum[t].BackPrev;do{e._optimum[t].Prev1IsChar&&(pe(e._optimum[r]),e._optimum[r].PosPrev=r-1,e._optimum[t].Prev2&&(e._optimum[r-1].Prev1IsChar=0,e._optimum[r-1].PosPrev=e._optimum[t].PosPrev2,e._optimum[r-1].BackPrev=e._optimum[t].BackPrev2)),o=r,s=n,n=e._optimum[o].BackPrev,r=e._optimum[o].PosPrev,e._optimum[o].BackPrev=s,e._optimum[o].PosPrev=t,t=o}while(t>0);return e.backRes=e._optimum[0].BackPrev,e._optimumCurrentIndex=e._optimum[0].PosPrev,e._optimumCurrentIndex}function J(e){for(var t=0;t<16;++t)e._alignPrices[t]=ke(e._posAlignEncoder,t);e._alignPriceCount=0}function V(e){var t,s,n,r,o,i,a,c;for(r=4;r<128;++r)t=(2|1&(i=ne(r)))<<(n=(i>>1)-1),e.tempPrices[r]=Ee(e._posEncoders,t-i-1,n,r-t);for(o=0;o<4;++o){for(s=e._posSlotEncoder[o],a=o<<6,i=0;i<e._distTableSize;++i)e._posSlotPrices[a+i]=Be(s,i);for(i=14;i<e._distTableSize;++i)e._posSlotPrices[a+i]+=(i>>1)-1-4<<6;for(c=128*o,r=0;r<4;++r)e._distancesPrices[c+r]=e._posSlotPrices[a+r];for(;r<128;++r)e._distancesPrices[c+r]=e._posSlotPrices[a+ne(r)]+e.tempPrices[r]}e._matchPriceCount=0}function K(e,t){se(e),function(e,t){if(e._writeEndMark){Me(e._rangeEncoder,e._isMatch,(e._state<<4)+t,1),Me(e._rangeEncoder,e._isRep,e._state,0),e._state=e._state<7?7:10,ie(e._lenEncoder,e._rangeEncoder,0,t);var s=z(2);Pe(e._posSlotEncoder[s],e._rangeEncoder,63),Le(e._rangeEncoder,67108863,26),be(e._posAlignEncoder,e._rangeEncoder,15)}}(e,t&e._posStateMask);for(var s=0;s<5;++s)Re(e._rangeEncoder)}function Z(e,t){var s,n,r,o,i,a,c,d,l,u,_,m,h,p,f,g,v,P,B,b,k,S,E,w,L,D,R,x,I,T,A,F,z,H,N,W,G,$,q,Y,j,J,V,K;if(e._optimumEndIndex!=e._optimumCurrentIndex)return h=e._optimum[e._optimumCurrentIndex].PosPrev-e._optimumCurrentIndex,e.backRes=e._optimum[e._optimumCurrentIndex].BackPrev,e._optimumCurrentIndex=e._optimum[e._optimumCurrentIndex].PosPrev,h;if(e._optimumCurrentIndex=e._optimumEndIndex=0,e._longestMatchWasFound?(m=e._longestMatchLength,e._longestMatchWasFound=0):m=te(e),D=e._numDistancePairs,(w=M(e._matchFinder)+1)<2)return e.backRes=-1,1;for(w>273&&(w=273),q=0,l=0;l<4;++l)e.reps[l]=e._repDistances[l],e.repLens[l]=C(e._matchFinder,-1,e.reps[l],273),e.repLens[l]>e.repLens[q]&&(q=l);if(e.repLens[q]>=e._numFastBytes)return e.backRes=q,ee(e,(h=e.repLens[q])-1),h;if(m>=e._numFastBytes)return e.backRes=e._matchDistances[D-1]+4,ee(e,m-1),m;if(c=y(e._matchFinder,-1),v=y(e._matchFinder,-e._repDistances[0]-1-1),m<2&&c!=v&&e.repLens[q]<2)return e.backRes=-1,1;if(e._optimum[0].State=e._state,z=t&e._posStateMask,e._optimum[1].Price=Ce[e._isMatch[(e._state<<4)+z]>>>2]+he(le(e._literalEncoder,t,e._previousByte),e._state>=7,v,c),pe(e._optimum[1]),$=(P=Ce[2048-e._isMatch[(e._state<<4)+z]>>>2])+Ce[2048-e._isRep[e._state]>>>2],v==c&&(Y=$+function(e,t,s){return Ce[e._isRepG0[t]>>>2]+Ce[e._isRep0Long[(t<<4)+s]>>>2]}(e,e._state,z),Y<e._optimum[1].Price&&(e._optimum[1].Price=Y,function(e){e.BackPrev=0,e.Prev1IsChar=0}(e._optimum[1]))),(_=m>=e.repLens[q]?m:e.repLens[q])<2)return e.backRes=e._optimum[1].BackPrev,1;e._optimum[1].PosPrev=0,e._optimum[0].Backs0=e.reps[0],e._optimum[0].Backs1=e.reps[1],e._optimum[0].Backs2=e.reps[2],e._optimum[0].Backs3=e.reps[3],u=_;do{e._optimum[u--].Price=268435455}while(u>=2);for(l=0;l<4;++l)if(!((G=e.repLens[l])<2)){N=$+X(e,l,e._state,z);do{(o=N+ce(e._repMatchLenEncoder,G-2,z))<(T=e._optimum[G]).Price&&(T.Price=o,T.PosPrev=0,T.BackPrev=l,T.Prev1IsChar=0)}while(--G>=2)}if(E=P+Ce[e._isRep[e._state]>>>2],(u=e.repLens[0]>=2?e.repLens[0]+1:2)<=m){for(R=0;u>e._matchDistances[R];)R+=2;for(;(o=E+Q(e,d=e._matchDistances[R+1],u,z))<(T=e._optimum[u]).Price&&(T.Price=o,T.PosPrev=0,T.BackPrev=d+4,T.Prev1IsChar=0),u!=e._matchDistances[R]||(R+=2)!=D;++u);}for(s=0;;){if(++s==_)return U(e,s);if(B=te(e),D=e._numDistancePairs,B>=e._numFastBytes)return e._longestMatchLength=B,e._longestMatchWasFound=1,U(e,s);if(++t,F=e._optimum[s].PosPrev,e._optimum[s].Prev1IsChar?(--F,e._optimum[s].Prev2?(J=e._optimum[e._optimum[s].PosPrev2].State,J=e._optimum[s].BackPrev2<4?J<7?8:11:J<7?7:10):J=e._optimum[F].State,J=O(J)):J=e._optimum[F].State,F==s-1?J=e._optimum[s].BackPrev?O(J):J<7?9:11:(e._optimum[s].Prev1IsChar&&e._optimum[s].Prev2?(F=e._optimum[s].PosPrev2,A=e._optimum[s].BackPrev2,J=J<7?8:11):J=(A=e._optimum[s].BackPrev)<4?J<7?8:11:J<7?7:10,I=e._optimum[F],A<4?A?1==A?(e.reps[0]=I.Backs1,e.reps[1]=I.Backs0,e.reps[2]=I.Backs2,e.reps[3]=I.Backs3):2==A?(e.reps[0]=I.Backs2,e.reps[1]=I.Backs0,e.reps[2]=I.Backs1,e.reps[3]=I.Backs3):(e.reps[0]=I.Backs3,e.reps[1]=I.Backs0,e.reps[2]=I.Backs1,e.reps[3]=I.Backs2):(e.reps[0]=I.Backs0,e.reps[1]=I.Backs1,e.reps[2]=I.Backs2,e.reps[3]=I.Backs3):(e.reps[0]=A-4,e.reps[1]=I.Backs0,e.reps[2]=I.Backs1,e.reps[3]=I.Backs2)),e._optimum[s].State=J,e._optimum[s].Backs0=e.reps[0],e._optimum[s].Backs1=e.reps[1],e._optimum[s].Backs2=e.reps[2],e._optimum[s].Backs3=e.reps[3],a=e._optimum[s].Price,c=y(e._matchFinder,-1),v=y(e._matchFinder,-e.reps[0]-1-1),z=t&e._posStateMask,b=0,(n=a+Ce[e._isMatch[(J<<4)+z]>>>2]+he(le(e._literalEncoder,t,y(e._matchFinder,-2)),J>=7,v,c))<(k=e._optimum[s+1]).Price&&(k.Price=n,k.PosPrev=s,k.BackPrev=-1,k.Prev1IsChar=0,b=1),$=(P=a+Ce[2048-e._isMatch[(J<<4)+z]>>>2])+Ce[2048-e._isRep[J]>>>2],v!=c||k.PosPrev<s&&!k.BackPrev||(Y=$+(Ce[e._isRepG0[J]>>>2]+Ce[e._isRep0Long[(J<<4)+z]>>>2]))<=k.Price&&(k.Price=Y,k.PosPrev=s,k.BackPrev=0,k.Prev1IsChar=0,b=1),!((w=L=4095-s<(L=M(e._matchFinder)+1)?4095-s:L)<2)){if(w>e._numFastBytes&&(w=e._numFastBytes),!b&&v!=c&&(K=Math.min(L-1,e._numFastBytes),(f=C(e._matchFinder,0,e.reps[0],K))>=2)){for(V=O(J),H=t+1&e._posStateMask,S=n+Ce[2048-e._isMatch[(V<<4)+H]>>>2]+Ce[2048-e._isRep[V]>>>2],x=s+1+f;_<x;)e._optimum[++_].Price=268435455;(o=S+(ce(e._repMatchLenEncoder,f-2,H)+X(e,0,V,H)))<(T=e._optimum[x]).Price&&(T.Price=o,T.PosPrev=s+1,T.BackPrev=0,T.Prev1IsChar=1,T.Prev2=0)}for(j=2,W=0;W<4;++W)if(!((p=C(e._matchFinder,-1,e.reps[W],w))<2)){g=p;do{for(;_<s+p;)e._optimum[++_].Price=268435455;(o=$+(ce(e._repMatchLenEncoder,p-2,z)+X(e,W,J,z)))<(T=e._optimum[s+p]).Price&&(T.Price=o,T.PosPrev=s,T.BackPrev=W,T.Prev1IsChar=0)}while(--p>=2);if(p=g,W||(j=p+1),p<L&&(K=Math.min(L-1-p,e._numFastBytes),(f=C(e._matchFinder,p,e.reps[W],K))>=2)){for(V=J<7?8:11,H=t+p&e._posStateMask,r=$+(ce(e._repMatchLenEncoder,p-2,z)+X(e,W,J,z))+Ce[e._isMatch[(V<<4)+H]>>>2]+he(le(e._literalEncoder,t+p,y(e._matchFinder,p-1-1)),1,y(e._matchFinder,p-1-(e.reps[W]+1)),y(e._matchFinder,p-1)),V=O(V),H=t+p+1&e._posStateMask,S=r+Ce[2048-e._isMatch[(V<<4)+H]>>>2]+Ce[2048-e._isRep[V]>>>2],x=p+1+f;_<s+x;)e._optimum[++_].Price=268435455;(o=S+(ce(e._repMatchLenEncoder,f-2,H)+X(e,0,V,H)))<(T=e._optimum[s+x]).Price&&(T.Price=o,T.PosPrev=s+p+1,T.BackPrev=0,T.Prev1IsChar=1,T.Prev2=1,T.PosPrev2=s,T.BackPrev2=W)}}if(B>w){for(B=w,D=0;B>e._matchDistances[D];D+=2);e._matchDistances[D]=B,D+=2}if(B>=j){for(E=P+Ce[e._isRep[J]>>>2];_<s+B;)e._optimum[++_].Price=268435455;for(R=0;j>e._matchDistances[R];)R+=2;for(p=j;;++p)if((o=E+Q(e,i=e._matchDistances[R+1],p,z))<(T=e._optimum[s+p]).Price&&(T.Price=o,T.PosPrev=s,T.BackPrev=i+4,T.Prev1IsChar=0),p==e._matchDistances[R]){if(p<L&&(K=Math.min(L-1-p,e._numFastBytes),(f=C(e._matchFinder,p,i,K))>=2)){for(V=J<7?7:10,H=t+p&e._posStateMask,r=o+Ce[e._isMatch[(V<<4)+H]>>>2]+he(le(e._literalEncoder,t+p,y(e._matchFinder,p-1-1)),1,y(e._matchFinder,p-(i+1)-1),y(e._matchFinder,p-1)),V=O(V),H=t+p+1&e._posStateMask,S=r+Ce[2048-e._isMatch[(V<<4)+H]>>>2]+Ce[2048-e._isRep[V]>>>2],x=p+1+f;_<s+x;)e._optimum[++_].Price=268435455;(o=S+(ce(e._repMatchLenEncoder,f-2,H)+X(e,0,V,H)))<(T=e._optimum[s+x]).Price&&(T.Price=o,T.PosPrev=s+p+1,T.BackPrev=0,T.Prev1IsChar=1,T.Prev2=1,T.PosPrev2=s,T.BackPrev2=i+4)}if((R+=2)==D)break}}}}}function Q(e,t,s,n){var r=z(s);return(t<128?e._distancesPrices[128*r+t]:e._posSlotPrices[(r<<6)+function(e){return e<131072?j[e>>6]+12:e<134217728?j[e>>16]+32:j[e>>26]+52}(t)]+e._alignPrices[15&t])+ce(e._lenEncoder,s-2,n)}function X(e,t,s,n){var r;return t?(r=Ce[2048-e._isRepG0[s]>>>2],1==t?r+=Ce[e._isRepG1[s]>>>2]:(r+=Ce[2048-e._isRepG1[s]>>>2],r+=xe(e._isRepG2[s],t-2))):(r=Ce[e._isRepG0[s]>>>2],r+=Ce[2048-e._isRep0Long[(s<<4)+n]>>>2]),r}function ee(e,t){t>0&&(function(e,t){var s,n,r,o,i,a,c,d,l,u,_,m,h,p,f,g,v;do{if(e._pos+e._matchMaxLen<=e._streamPos)m=e._matchMaxLen;else if((m=e._streamPos-e._pos)<e.kMinMatchCheck){x(e);continue}for(h=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,n=e._bufferOffset+e._pos,e.HASH_ARRAY?(a=1023&(v=R[255&e._bufferBase[n]]^255&e._bufferBase[n+1]),e._hash[a]=e._pos,c=65535&(v^=(255&e._bufferBase[n+2])<<8),e._hash[1024+c]=e._pos,d=(v^R[255&e._bufferBase[n+3]]<<5)&e._hashMask):d=255&e._bufferBase[n]^(255&e._bufferBase[n+1])<<8,r=e._hash[e.kFixHashSize+d],e._hash[e.kFixHashSize+d]=e._pos,f=1+(e._cyclicBufferPos<<1),g=e._cyclicBufferPos<<1,u=_=e.kNumHashDirectBytes,s=e._cutValue;;){if(r<=h||0==s--){e._son[f]=e._son[g]=0;break}if(o=((i=e._pos-r)<=e._cyclicBufferPos?e._cyclicBufferPos-i:e._cyclicBufferPos-i+e._cyclicBufferSize)<<1,p=e._bufferOffset+r,l=u<_?u:_,e._bufferBase[p+l]==e._bufferBase[n+l]){for(;++l!=m&&e._bufferBase[p+l]==e._bufferBase[n+l];);if(l==m){e._son[g]=e._son[o],e._son[f]=e._son[o+1];break}}(255&e._bufferBase[p+l])<(255&e._bufferBase[n+l])?(e._son[g]=r,g=o+1,r=e._son[g],_=l):(e._son[f]=r,f=o,r=e._son[f],u=l)}x(e)}while(0!=--t)}(e._matchFinder,t),e._additionalOffset+=t)}function te(e){var t=0;return e._numDistancePairs=function(e,t){var s,n,r,o,i,a,c,d,l,u,_,m,h,p,f,g,v,P,B,b,k;if(e._pos+e._matchMaxLen<=e._streamPos)p=e._matchMaxLen;else if((p=e._streamPos-e._pos)<e.kMinMatchCheck)return x(e),0;for(v=0,f=e._pos>e._cyclicBufferSize?e._pos-e._cyclicBufferSize:0,n=e._bufferOffset+e._pos,g=1,d=0,l=0,e.HASH_ARRAY?(d=1023&(k=R[255&e._bufferBase[n]]^255&e._bufferBase[n+1]),l=65535&(k^=(255&e._bufferBase[n+2])<<8),u=(k^R[255&e._bufferBase[n+3]]<<5)&e._hashMask):u=255&e._bufferBase[n]^(255&e._bufferBase[n+1])<<8,r=e._hash[e.kFixHashSize+u]||0,e.HASH_ARRAY&&(o=e._hash[d]||0,i=e._hash[1024+l]||0,e._hash[d]=e._pos,e._hash[1024+l]=e._pos,o>f&&e._bufferBase[e._bufferOffset+o]==e._bufferBase[n]&&(t[v++]=g=2,t[v++]=e._pos-o-1),i>f&&e._bufferBase[e._bufferOffset+i]==e._bufferBase[n]&&(i==o&&(v-=2),t[v++]=g=3,t[v++]=e._pos-i-1,o=i),0!=v&&o==r&&(v-=2,g=1)),e._hash[e.kFixHashSize+u]=e._pos,B=1+(e._cyclicBufferPos<<1),b=e._cyclicBufferPos<<1,m=h=e.kNumHashDirectBytes,0!=e.kNumHashDirectBytes&&r>f&&e._bufferBase[e._bufferOffset+r+e.kNumHashDirectBytes]!=e._bufferBase[n+e.kNumHashDirectBytes]&&(t[v++]=g=e.kNumHashDirectBytes,t[v++]=e._pos-r-1),s=e._cutValue;;){if(r<=f||0==s--){e._son[B]=e._son[b]=0;break}if(a=((c=e._pos-r)<=e._cyclicBufferPos?e._cyclicBufferPos-c:e._cyclicBufferPos-c+e._cyclicBufferSize)<<1,P=e._bufferOffset+r,_=m<h?m:h,e._bufferBase[P+_]==e._bufferBase[n+_]){for(;++_!=p&&e._bufferBase[P+_]==e._bufferBase[n+_];);if(g<_&&(t[v++]=g=_,t[v++]=c-1,_==p)){e._son[b]=e._son[a],e._son[B]=e._son[a+1];break}}(255&e._bufferBase[P+_])<(255&e._bufferBase[n+_])?(e._son[b]=r,b=a+1,r=e._son[b],h=_):(e._son[B]=r,B=a,r=e._son[B],m=_)}return x(e),v}(e._matchFinder,e._matchDistances),e._numDistancePairs>0&&(t=e._matchDistances[e._numDistancePairs-2])==e._numFastBytes&&(t+=C(e._matchFinder,t-1,e._matchDistances[e._numDistancePairs-1],273-t)),++e._additionalOffset,t}function se(e){e._matchFinder&&e._needReleaseMFStream&&(e._matchFinder._stream=null,e._needReleaseMFStream=0)}function ne(e){return e<2048?j[e]:e<2097152?j[e>>10]+20:j[e>>20]+40}function re(e,t){ye(e._choice);for(var s=0;s<t;++s)ye(e._lowCoder[s].Models),ye(e._midCoder[s].Models);ye(e._highCoder.Models)}function oe(e,t,s,n,r){var o,i,a,c,d;for(o=Ce[e._choice[0]>>>2],a=(i=Ce[2048-e._choice[0]>>>2])+Ce[e._choice[1]>>>2],c=i+Ce[2048-e._choice[1]>>>2],d=0,d=0;d<8;++d){if(d>=s)return;n[r+d]=o+Be(e._lowCoder[t],d)}for(;d<16;++d){if(d>=s)return;n[r+d]=a+Be(e._midCoder[t],d-8)}for(;d<s;++d)n[r+d]=c+Be(e._highCoder,d-8-8)}function ie(e,t,s,n){!function(e,t,s,n){s<8?(Me(t,e._choice,0,0),Pe(e._lowCoder[n],t,s)):(s-=8,Me(t,e._choice,0,1),s<8?(Me(t,e._choice,1,0),Pe(e._midCoder[n],t,s)):(Me(t,e._choice,1,1),Pe(e._highCoder,t,s-8)))}(e,t,s,n),0==--e._counters[n]&&(oe(e,n,e._tableSize,e._prices,272*n),e._counters[n]=e._tableSize)}function ae(e){return function(e){e._choice=a(2),e._lowCoder=a(16),e._midCoder=a(16),e._highCoder=ve({},8);for(var t=0;t<16;++t)e._lowCoder[t]=ve({},3),e._midCoder[t]=ve({},3)}(e),e._prices=[],e._counters=[],e}function ce(e,t,s){return e._prices[272*s+t]}function de(e,t){for(var s=0;s<t;++s)oe(e,s,e._tableSize,e._prices,272*s),e._counters[s]=e._tableSize}function le(e,t,s){return e.m_Coders[((t&e.m_PosMask)<<e.m_NumPrevBits)+((255&s)>>>8-e.m_NumPrevBits)]}function ue(e,t,s){var n,r,o=1;for(r=7;r>=0;--r)n=s>>r&1,Me(t,e.m_Encoders,o,n),o=o<<1|n}function _e(e,t,s,n){var r,o,i,a,c=1,d=1;for(o=7;o>=0;--o)r=n>>o&1,a=d,c&&(a+=1+(i=s>>o&1)<<8,c=i==r),Me(t,e.m_Encoders,a,r),d=d<<1|r}function me(e){return e.m_Encoders=a(768),e}function he(e,t,s,n){var r,o,i=1,a=7,c=0;if(t)for(;a>=0;--a)if(o=s>>a&1,r=n>>a&1,c+=xe(e.m_Encoders[(1+o<<8)+i],r),i=i<<1|r,o!=r){--a;break}for(;a>=0;--a)r=n>>a&1,c+=xe(e.m_Encoders[i],r),i=i<<1|r;return c}function pe(e){e.BackPrev=-1,e.Prev1IsChar=0}function fe(e,t){return e.NumBitLevels=t,e.Models=a(1<<t),e}function ge(e,t){var s,n=1;for(s=e.NumBitLevels;0!=s;--s)n=(n<<1)+we(t,e.Models,n);return n-(1<<e.NumBitLevels)}function ve(e,t){return e.NumBitLevels=t,e.Models=a(1<<t),e}function Pe(e,t,s){var n,r,o=1;for(r=e.NumBitLevels;0!=r;)n=s>>>--r&1,Me(t,e.Models,o,n),o=o<<1|n}function Be(e,t){var s,n,r=1,o=0;for(n=e.NumBitLevels;0!=n;)s=t>>>--n&1,o+=xe(e.Models[r],s),r=(r<<1)+s;return o}function be(e,t,s){var n,r,o=1;for(r=0;r<e.NumBitLevels;++r)n=1&s,Me(t,e.Models,o,n),o=o<<1|n,s>>=1}function ke(e,t){var s,n,r=1,o=0;for(n=e.NumBitLevels;0!=n;--n)s=1&t,t>>>=1,o+=xe(e.Models[r],s),r=r<<1|s;return o}function Se(e,t,s,n,r){var o,i,a=1;for(i=0;i<n;++i)Me(s,e,t+a,o=1&r),a=a<<1|o,r>>=1}function Ee(e,t,s,n){var r,o,i=1,a=0;for(o=s;0!=o;--o)r=1&n,n>>>=1,a+=Ce[(2047&(e[t+i]-r^-r))>>>2],i=i<<1|r;return a}function we(e,t,s){var n,r=t[s];return n=(e.Range>>>11)*r,(-2147483648^e.Code)<(-2147483648^n)?(e.Range=n,t[s]=r+(2048-r>>>5)<<16>>16,-16777216&e.Range||(e.Code=e.Code<<8|P(e.Stream),e.Range<<=8),0):(e.Range-=n,e.Code-=n,t[s]=r-(r>>>5)<<16>>16,-16777216&e.Range||(e.Code=e.Code<<8|P(e.Stream),e.Range<<=8),1)}function ye(e){for(var t=e.length-1;t>=0;--t)e[t]=1024}var Ce=function(){var e,t,s,n=[];for(t=8;t>=0;--t)for(e=1<<9-t,s=1<<9-t-1;s<e;++s)n[s]=(t<<6)+(e-s<<6>>>9-t-1);return n}();function Me(e,t,s,n){var r,o=t[s];r=(e.Range>>>11)*o,n?(e.Low=i(e.Low,c(_(r),[4294967295,0])),e.Range-=r,t[s]=o-(o>>>5)<<16>>16):(e.Range=r,t[s]=o+(2048-o>>>5)<<16>>16),-16777216&e.Range||(e.Range<<=8,Re(e))}function Le(e,t,s){for(var n=s-1;n>=0;--n)e.Range>>>=1,1==(t>>>n&1)&&(e.Low=i(e.Low,_(e.Range))),-16777216&e.Range||(e.Range<<=8,Re(e))}function De(e){return i(i(_(e._cacheSize),e._position),[4,0])}function Re(e){var t,s,n,r,o=m((n=32,r=f(s=e.Low,n&=63),s[1]<0&&(r=i(r,p([2,0],31))),r));if(0!=o||d(e.Low,[4278190080,0])<0){e._position=i(e._position,_(e._cacheSize)),t=e._cache;do{S(e.Stream,t+o),t=255}while(0!=--e._cacheSize);e._cache=m(e.Low)>>>24}++e._cacheSize,e.Low=p(c(e.Low,[16777215,0]),8)}function xe(e,t){return Ce[(2047&(e-t^-t))>>>2]}const Ie=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}];function Te(e,{mode:t=7,enableEndMark:n=!0}={}){var o={};for(o.c=function(e,t,n,o){return e.output=b({}),function(e,t,n,o,i,c){var l,u;if(d(o,s)<0)throw new Error("invalid length "+o);for(e.length_0=o,l=function(e){var t;for(e._repDistances=a(4),e._optimum=[],e._rangeEncoder={},e._isMatch=a(192),e._isRep=a(12),e._isRepG0=a(12),e._isRepG1=a(12),e._isRepG2=a(12),e._isRep0Long=a(192),e._posSlotEncoder=[],e._posEncoders=a(114),e._posAlignEncoder=ve({},4),e._lenEncoder=ae({}),e._repMatchLenEncoder=ae({}),e._literalEncoder={},e._matchDistances=[],e._posSlotPrices=[],e._distancesPrices=[],e._alignPrices=a(16),e.reps=a(4),e.repLens=a(4),e.processedInSize=[r],e.processedOutSize=[r],e.finished=[0],e.properties=a(5),e.tempPrices=a(128),e._longestMatchLength=0,e._matchFinderType=1,e._numDistancePairs=0,e._numFastBytesPrev=-1,e.backRes=0,t=0;t<4096;++t)e._optimum[t]={};for(t=0;t<4;++t)e._posSlotEncoder[t]=ve({},6);return e}({}),function(e,t){!function(e,t){e._dictionarySize=t;for(var s=0;t>1<<s;++s);e._distTableSize=2*s}(t,1<<e.s),t._numFastBytes=e.f,function(e,t){var s=e._matchFinderType;e._matchFinderType=t,e._matchFinder&&s!=e._matchFinderType&&(e._dictionarySizePrev=-1,e._matchFinder=null)}(t,e.m),t._numLiteralPosStateBits=0,t._numLiteralContextBits=3,t._posStateBits=2,t._posStateMask=3}(i,l),l._writeEndMark=c,function(e,t){e.properties[0]=9*(5*e._posStateBits+e._numLiteralPosStateBits)+e._numLiteralContextBits<<24>>24;for(var s=0;s<4;++s)e.properties[1+s]=e._dictionarySize>>8*s<<24>>24;E(t,e.properties,0,5)}(l,n),u=0;u<64;u+=8)S(n,255&m(f(o,u)));e.chunker=(l._needReleaseMFStream=0,l._inStream=t,l._finished=0,function(e){var t,s;e._matchFinder||(t={},s=4,e._matchFinderType||(s=2),function(e,t){e.HASH_ARRAY=t>2,e.HASH_ARRAY?(e.kNumHashDirectBytes=0,e.kMinMatchCheck=4,e.kFixHashSize=66560):(e.kNumHashDirectBytes=2,e.kMinMatchCheck=3,e.kFixHashSize=0)}(t,s),e._matchFinder=t),function(e,t,s){var n,r;if(null==e.m_Coders||e.m_NumPrevBits!=s||e.m_NumPosBits!=t)for(e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=s,r=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=a(r),n=0;n<r;++n)e.m_Coders[n]=me({})}(e._literalEncoder,e._numLiteralPosStateBits,e._numLiteralContextBits),(e._dictionarySize!=e._dictionarySizePrev||e._numFastBytesPrev!=e._numFastBytes)&&(function(e,t,s,n,r){var o,i;t<1073741567&&(e._cutValue=16+(n>>1),function(e,t,s,n){var r;e._keepSizeBefore=t,e._keepSizeAfter=s,r=t+s+n,(null==e._bufferBase||e._blockSize!=r)&&(e._bufferBase=null,e._blockSize=r,e._bufferBase=a(e._blockSize)),e._pointerToLastSafePosition=e._blockSize-s}(e,t+4096,n+274,256+~~((t+4096+n+274)/2)),e._matchMaxLen=n,o=t+1,e._cyclicBufferSize!=o&&(e._son=a(2*(e._cyclicBufferSize=o))),i=65536,e.HASH_ARRAY&&(i=t-1,i|=i>>1,i|=i>>2,i|=i>>4,i|=i>>8,i>>=1,(i|=65535)>16777216&&(i>>=1),e._hashMask=i,++i,i+=e.kFixHashSize),i!=e._hashSizeSum&&(e._hash=a(e._hashSizeSum=i)))}(e._matchFinder,e._dictionarySize,0,e._numFastBytes),e._dictionarySizePrev=e._dictionarySize,e._numFastBytesPrev=e._numFastBytes)}(l),l._rangeEncoder.Stream=n,function(e){(function(e){e._state=0,e._previousByte=0;for(var t=0;t<4;++t)e._repDistances[t]=0})(e),function(e){e._position=r,e.Low=r,e.Range=-1,e._cacheSize=1,e._cache=0}(e._rangeEncoder),ye(e._isMatch),ye(e._isRep0Long),ye(e._isRep),ye(e._isRepG0),ye(e._isRepG1),ye(e._isRepG2),ye(e._posEncoders),function(e){var t,s=1<<e.m_NumPrevBits+e.m_NumPosBits;for(t=0;t<s;++t)ye(e.m_Coders[t].m_Encoders)}(e._literalEncoder);for(var t=0;t<4;++t)ye(e._posSlotEncoder[t].Models);re(e._lenEncoder,1<<e._posStateBits),re(e._repMatchLenEncoder,1<<e._posStateBits),ye(e._posAlignEncoder.Models),e._longestMatchWasFound=0,e._optimumEndIndex=0,e._optimumCurrentIndex=0,e._additionalOffset=0}(l),V(l),J(l),l._lenEncoder._tableSize=l._numFastBytes+1-2,de(l._lenEncoder,1<<l._posStateBits),l._repMatchLenEncoder._tableSize=l._numFastBytes+1-2,de(l._repMatchLenEncoder,1<<l._posStateBits),l.nowPos64=r,function(e,t){return e.encoder=t,e.decoder=null,e.alive=1,e}({},l))}(e,v({},t),e.output,_(t.length),n,o),e}({},function(e){var t,s,n,r=[],o=0,i=e.length;if("object"==typeof e)return e;for(function(e,t,s,n,r){var o;for(o=0;o<s;++o)n[r++]=e.charCodeAt(o)}(e,0,i,r,0),n=0;n<i;++n)(t=r[n])>=1&&t<=127?++o:o+=!t||t>=128&&t<=2047?2:3;for(s=[],o=0,n=0;n<i;++n)(t=r[n])>=1&&t<=127?s[o++]=t<<24>>24:!t||t>=128&&t<=2047?(s[o++]=(192|t>>6&31)<<24>>24,s[o++]=(128|63&t)<<24>>24):(s[o++]=(224|t>>12&15)<<24>>24,s[o++]=(128|t>>6&63)<<24>>24,s[o++]=(128|63&t)<<24>>24);return s}(e),function(e){return Ie[e-1]||Ie[6]}(t),n);H(o.c.chunker););return k(o.c.output)}function Ae(e){var t={};for(t.d=function(e,t){return e.output=b({}),function(e,t,n){var o,i,c,d,l="",u=[];for(i=0;i<5;++i){if(-1==(c=P(t)))throw new Error("truncated input");u[i]=c<<24>>24}if(o=function(e){e.m_OutWindow={},e.m_RangeDecoder={},e.m_IsMatchDecoders=a(192),e.m_IsRepDecoders=a(12),e.m_IsRepG0Decoders=a(12),e.m_IsRepG1Decoders=a(12),e.m_IsRepG2Decoders=a(12),e.m_IsRep0LongDecoders=a(192),e.m_PosSlotDecoder=a(4),e.m_PosDecoders=a(114),e.m_PosAlignDecoder=fe({},4),e.m_LenDecoder=G({}),e.m_RepLenDecoder=G({}),e.m_LiteralDecoder={};for(var t=0;t<4;++t)e.m_PosSlotDecoder[t]=fe({},6);return e}({}),!function(e,t){var s,n,r,o,i,c,d;if(t.length<5)return 0;for(r=(d=255&t[0])%9,o=(c=~~(d/9))%5,i=~~(c/5),s=0,n=0;n<4;++n)s+=(255&t[1+n])<<8*n;return s>99999999||!function(e,t,s,n){if(t>8||s>4||n>4)return 0;!function(e,t,s){var n,r;if(null==e.m_Coders||e.m_NumPrevBits!=s||e.m_NumPosBits!=t)for(e.m_NumPosBits=t,e.m_PosMask=(1<<t)-1,e.m_NumPrevBits=s,r=1<<e.m_NumPrevBits+e.m_NumPosBits,e.m_Coders=a(r),n=0;n<r;++n)e.m_Coders[n]=Y({})}(e.m_LiteralDecoder,s,t);var r=1<<n;return N(e.m_LenDecoder,r),N(e.m_RepLenDecoder,r),e.m_PosStateMask=r-1,1}(e,r,o,i)?0:function(e,t){return t<0?0:(e.m_DictionarySize!=t&&(e.m_DictionarySize=t,e.m_DictionarySizeCheck=Math.max(e.m_DictionarySize,1),function(e,t){null!=e._buffer&&e._windowSize==t||(e._buffer=a(t)),e._windowSize=t,e._pos=0,e._streamPos=0}(e.m_OutWindow,Math.max(e.m_DictionarySizeCheck,4096))),1)}(e,s)}(o,u))throw new Error("corrupted input");for(i=0;i<64;i+=8){if(-1==(c=P(t)))throw new Error("truncated input");1==(c=c.toString(16)).length&&(c="0"+c),l=c+""+l}/^0+$|^f+$/i.test(l)?e.length_0=s:(d=parseInt(l,16),e.length_0=d>4294967295?s:_(d)),e.chunker=function(e,t,s,n){return e.m_RangeDecoder.Stream=t,F(e.m_OutWindow),e.m_OutWindow._stream=s,function(e){e.m_OutWindow._streamPos=0,e.m_OutWindow._pos=0,ye(e.m_IsMatchDecoders),ye(e.m_IsRep0LongDecoders),ye(e.m_IsRepDecoders),ye(e.m_IsRepG0Decoders),ye(e.m_IsRepG1Decoders),ye(e.m_IsRepG2Decoders),ye(e.m_PosDecoders),function(e){var t,s;for(s=1<<e.m_NumPrevBits+e.m_NumPosBits,t=0;t<s;++t)ye(e.m_Coders[t].m_Decoders)}(e.m_LiteralDecoder);for(var t=0;t<4;++t)ye(e.m_PosSlotDecoder[t].Models);q(e.m_LenDecoder),q(e.m_RepLenDecoder),ye(e.m_PosAlignDecoder.Models),function(e){e.Code=0,e.Range=-1;for(var t=0;t<5;++t)e.Code=e.Code<<8|P(e.Stream)}(e.m_RangeDecoder)}(e),e.state=0,e.rep0=0,e.rep1=0,e.rep2=0,e.rep3=0,e.outSize=n,e.nowPos64=r,e.prevByte=0,function(e,t){return e.decoder=t,e.encoder=null,e.alive=1,e}({},e)}(o,t,n,e.length_0)}(e,v({},t),e.output),e}({},e);H(t.d.chunker););return function(e){for(var t,s,n,r=0,o=0,i=e.length,a=[],c=[];r<i;++r,++o){if(128&(t=255&e[r]))if(192==(224&t)){if(r+1>=i)return e;if(128!=(192&(s=255&e[++r])))return e;c[o]=(31&t)<<6|63&s}else{if(224!=(240&t))return e;if(r+2>=i)return e;if(128!=(192&(s=255&e[++r])))return e;if(128!=(192&(n=255&e[++r])))return e;c[o]=(15&t)<<12|(63&s)<<6|63&n}else{if(!t)return e;c[o]=t}16383==o&&(a.push(String.fromCharCode.apply(String,c)),o=-1)}return o>0&&(c.length=o,a.push(String.fromCharCode.apply(String,c))),a.join("")}(k(t.d.output))}var Fe;!function(e){e.General="General",e.Weapon_Skill="Weapon Skill",e.Ballistic_Skill="Ballistic Skill",e.Strength="Strength",e.Toughness="Toughness",e.Agility="Agility",e.Intelligence="Intelligence",e.Perception="Perception",e.Willpower="Willpower",e.Fellowship="Fellowship",e.Offence="Offence",e.Finesse="Finesse",e.Defence="Defence",e.Psyker="Psyker",e.Tech="Tech",e.Knowledge="Knowledge",e.Leadership="Leadership",e.Fieldcraft="Fieldcraft",e.Social="Social"}(Fe||(Fe={}));class ze{class=null;matches=0;constructor(e,t){this.class=e,this.matches=t}}class Oe{role=null;matches=0;constructor(e,t){this.role=e,this.matches=t}}class He{world=null;matches=0;constructor(e,t){this.world=e,this.matches=t}}class Ne{background=null;matches=0;constructor(e,t){this.background=e,this.matches=t}}class We{wishlist;skill_wishlist;characteristic_wishlist;skip0CbChecked;worldSelected;classSelected;backgroundSelected;roleSelected;extraAptitudesSelected;aptitudesWishlist;constructor(){this.wishlist="",this.skill_wishlist="",this.characteristic_wishlist="",this.aptitudesWishlist=[],this.skip0CbChecked=!1,this.worldSelected="",this.classSelected="",this.backgroundSelected="",this.roleSelected="",this.extraAptitudesSelected=[]}}class Ge{nodeMap=new Map;rootNode=new $e("");nodeCount=0;treeBuild=!1;get(e){return this.nodeMap.get(e)}getOrCreate(e){let t=this.nodeMap.get(e);return t||(this.nodeCount++,t=new $e(e),this.nodeMap.set(e,t)),t}linkParentToChild(e,t){e.children.push(t),t.parents.push(e)}buildTree(e){if(this.treeBuild)return this;if(e)for(const e of this.nodeMap.values())0===e.parents.length&&this.linkParentToChild(this.rootNode,e);for(const e of this.nodeMap.values())e.children.sort(((e,t)=>e.name.localeCompare(t.name)));return e&&this.rootNode.children.sort(((e,t)=>e.name.localeCompare(t.name))),this.treeBuild=!0,this}iterateParents(e){const t=[];for(const s of e.parents)t.push(...this.iterateParents(s)),t.push(s);return t}}class $e{name;parents;children;data;constructor(e){this.name=e,this.data=null,this.parents=[],this.children=[]}}(new class{tree=new Ge;fullTree=new Ge;data;configData=new We;selectedAptitudes=[];source="ow";start(){const e=window.location.search,t=new URLSearchParams(e),s=t.get("source"),n=t.get("cfg"),r=s||"ow";fetch("assets/w40k-"+r+".json").then((e=>e.json())).then((e=>this.$start(e,r,n)))}$start(e,t,s){this.data=e,this.source=t,this.buildFullTree();const n=localStorage.getItem("w40k-data-config-"+t);if(s)if(s.startsWith("%7B")||s.startsWith("{"))console.log("load-json","w40k-data-config-"+this.source,s),this.configData=JSON.parse(s);else{const e=Ae(new Int8Array(function(e,t){for(var s,n,r,o=e.replace(/[^A-Za-z0-9\+\/]/g,""),i=o.length,a=3*i+1>>>2,c=new Uint8Array(a),d=0,l=0,u=0;u<i;u++)if(n=3&u,d|=((r=o.charCodeAt(u))>64&&r<91?r-65:r>96&&r<123?r-71:r>47&&r<58?r+4:43===r?62:47===r?63:0)<<18-6*n,3===n||i-u==1){for(s=0;s<3&&l<a;s++,l++)c[l]=d>>>(16>>>s&24)&255;d=0}return c}(decodeURIComponent(s).replace(/-/g,"+").replace(/_/g,"/"))));console.log("load-compressed","w40k-data-config-"+this.source,e),this.configData=JSON.parse(e)}else n&&(console.log("load-browser","w40k-data-config-"+this.source,n),this.configData=JSON.parse(n));const r=document.getElementById("classSelectContainer");if(this.data.classes&&this.data.classes.length>0){const e=document.getElementById("classSelect");{const t=document.createElement("option");t.text="None",e.add(t)}for(let t=0;t<this.data.classes.length;t++){const s=document.createElement("option"),n=this.data.classes[t].aptitudes,{apt:r,aptalt:o}=this.commonFunc2(n);s.text=this.data.classes[t].class+" ("+r.trim()+")",s.setAttribute("data-content",this.data.classes[t].class+" "+o),s.value=this.data.classes[t].class,this.configData.classSelected&&this.configData.classSelected==this.data.classes[t].class&&(s.selected=!0),e.add(s)}e.addEventListener("change",(e=>{this.triggerRecalc(e)}))}else r.style.display="none";const o=document.getElementById("worldSelectContainer");if(this.data.worlds&&this.data.worlds.length>0){const e=document.getElementById("worldSelect");{const t=document.createElement("option");t.text="None",e.add(t)}for(let t=0;t<this.data.worlds.length;t++){const s=document.createElement("option");s.text=this.data.worlds[t].world+" ("+this.data.worlds[t].aptitude+")",s.setAttribute("data-content",this.data.worlds[t].world+" <span class='badge badge-pill badge-secondary "+this.data.worlds[t].aptitude.replace(" ","_")+"'>"+this.data.worlds[t].aptitude+"</span>"),s.value=this.data.worlds[t].world,this.configData.worldSelected&&this.configData.worldSelected==this.data.worlds[t].world&&(s.selected=!0),e.add(s)}e.addEventListener("change",(e=>{this.triggerRecalc(e)}))}else o.style.display="none";const i=document.getElementById("backgroundSelectContainer");if(this.data.backgrounds&&this.data.backgrounds.length>0){const e=document.getElementById("backgroundSelect");{const t=document.createElement("option");t.text="None",e.add(t)}for(let t=0;t<this.data.backgrounds.length;t++){const s=document.createElement("option");s.text=this.data.backgrounds[t].background+" ("+this.data.backgrounds[t].aptitude+")",s.setAttribute("data-content",this.data.backgrounds[t].background+" <span class='badge badge-pill badge-secondary "+this.data.backgrounds[t].aptitude.replace(" ","_")+"'>"+this.data.backgrounds[t].aptitude+"</span>"),s.value=this.data.backgrounds[t].background,this.configData.backgroundSelected&&this.configData.backgroundSelected==this.data.backgrounds[t].background&&(s.selected=!0),e.add(s)}e.addEventListener("change",(e=>{this.triggerRecalc(e)}))}else i.style.display="none";const a=document.getElementById("roleSelectContainer");if(this.data.roles&&this.data.roles.length>0){const e=document.getElementById("roleSelect");{const t=document.createElement("option");t.text="None",e.add(t)}for(let t=0;t<this.data.roles.length;t++){const s=document.createElement("option"),n=this.data.roles[t].aptitudes,{apt:r,aptalt:o}=this.commonFunc2(n);s.text=this.data.roles[t].role+" ("+r.trim()+")",s.setAttribute("data-content",this.data.roles[t].role+" "+o),s.value=this.data.roles[t].role,this.configData.roleSelected&&this.configData.roleSelected==this.data.roles[t].role&&(s.selected=!0),e.add(s)}e.addEventListener("change",(e=>this.triggerRecalc(e)))}else a.style.display="none";const c=document.getElementById("aptitudeSelect");for(let e=0;e<this.data.optional.length;e++){const t=document.createElement("option");t.text=this.data.optional[e],t.value=this.data.optional[e],this.configData.extraAptitudesSelected&&this.configData.extraAptitudesSelected.includes(this.data.optional[e])&&(t.selected=!0),c.add(t)}c.addEventListener("change",(e=>this.triggerRecalc(e)));const d=document.getElementById("aptitudeWishlistSelect");for(let e=0;e<this.data.optional.length;e++){const t=document.createElement("option");t.text=this.data.optional[e],t.value=this.data.optional[e],this.configData.aptitudesWishlist&&this.configData.aptitudesWishlist.includes(this.data.optional[e])&&(t.selected=!0),d.add(t)}d.addEventListener("change",(t=>{this.logMatchingClasses(t,e),this.logMatchingWorlds(t,e),this.logMatchingBackgrounds(t,e),this.logMatchingRoles(t,e),this.styleAptitudeMatches(t,e)}));const l=document.getElementById("skip0Cb");l.checked=this.configData.skip0CbChecked,l.addEventListener("change",(e=>this.triggerRecalc(e)));const u=document.getElementById("characteristic_wishlist");u.value=this.configData.characteristic_wishlist,u.addEventListener("change",(e=>this.triggerRecalc(e)));const _=document.getElementById("skill_wishlist");_.value=this.configData.skill_wishlist,_.addEventListener("change",(e=>this.triggerRecalc(e)));const m=document.getElementById("wishlist");m.value=this.configData.wishlist,m.addEventListener("change",(e=>this.triggerRecalc(e))),document.getElementById("export_characteristic").addEventListener("click",(e=>this.copyToClipboardText("characteristic"))),document.getElementById("export_skill").addEventListener("click",(e=>this.copyToClipboardText("skill"))),document.getElementById("export_talent").addEventListener("click",(e=>this.copyToClipboardText("talent"))),document.getElementById("export_characteristic_wishlist").addEventListener("click",(e=>this.copyToClipboardWishlist("characteristic",2))),document.getElementById("export_skill_wishlist").addEventListener("click",(e=>this.copyToClipboardWishlist("skill",2))),document.getElementById("export_talent_wishlist").addEventListener("click",(e=>this.copyToClipboardWishlist("talent",3))),document.getElementById("export_all").addEventListener("click",(e=>this.exportAllTableToExcelDef("characteristic","skill","talent"))),document.getElementById("wishlist_clear").addEventListener("click",(e=>{m.value="",this.triggerRecalc(e)})),document.getElementById("skill_wishlist_clear").addEventListener("click",(e=>{_.value="",this.triggerRecalc(e)})),document.getElementById("characteristic_wishlist_clear").addEventListener("click",(e=>{u.value="",this.triggerRecalc(e)})),$("._selectpicker").selectpicker(),this.triggerRecalc(null),this.styleAptitudeMatches(null,e)}buildFullTree(){this.data.talents.forEach((e=>{const t=e.talent.toLowerCase().trim();this.data.talents.forEach((s=>{if(s.prerequisites.toLowerCase().includes(t)){const t=this.fullTree.getOrCreate(e.talent);t.data=e;const n=this.fullTree.getOrCreate(s.talent);n.data=s,this.fullTree.linkParentToChild(t,n)}}))})),this.fullTree.buildTree(!1)}scrollToAnchor(e){const t=document.getElementById(e),s=t.getBoundingClientRect().top+window.scrollY-100;window.scrollTo({top:s,behavior:"auto"});const n=["animate__animated","animate__faster","animate__flash"];t.classList.add(...n),t.addEventListener("animationend",(()=>t.classList.remove(...n)))}commonFunc2(e){let t="",s="";for(let n=0;n<e.length;n++)t+=e[n],s+="<span class='badge badge-pill badge-secondary "+e[n].replace(" ","_")+"'>"+e[n]+"</span>",n<e.length-1&&(t+=", ");return{apt:t,aptalt:s}}triggerRecalc(e){this.tree=new Ge;const t=document.getElementById("wishlist");this.configData.wishlist=t.value;const s=t.value.split("\n");for(let e=0;e<s.length;e++)""===s[e]&&(s.splice(e,1),e--);for(let e=0;e<s.length;e++)s[e]=s[e].toLowerCase().trim();const n=document.getElementById("skill_wishlist");this.configData.skill_wishlist=n.value;const r=n.value.split("\n");for(let e=0;e<r.length;e++)""===r[e]&&(r.splice(e,1),e--);for(let e=0;e<r.length;e++)r[e]=r[e].toLowerCase().trim();const o=document.getElementById("characteristic_wishlist");this.configData.characteristic_wishlist=o.value;const i=o.value.split("\n");for(let e=0;e<i.length;e++)""===i[e]&&(i.splice(e,1),e--);for(let e=0;e<i.length;e++)i[e]=i[e].toLowerCase().trim();this.selectedAptitudes=[];const a=document.getElementById("skip0Cb");this.configData.skip0CbChecked=a.checked;const c=a.checked;this.selectedAptitudes.push(this.data.free);const d=[],l=document.getElementById("classSelect");if(l.selectedIndex>0){const e=this.data.classes[l.selectedIndex-1],t=e.aptitudes;this.configData.classSelected=e.class;for(let e=0;e<t.length;e++)this.selectedAptitudes.includes(t[e])?d.push(t[e]):this.selectedAptitudes.push(t[e])}else this.configData.classSelected="";const u=document.getElementById("worldSelect");if(u.selectedIndex>0){const e=this.data.worlds[u.selectedIndex-1],t=e.aptitude;this.configData.worldSelected=e.world,this.selectedAptitudes.includes(t)?d.push(t):this.selectedAptitudes.push(t)}else this.configData.worldSelected="";const _=document.getElementById("roleSelect");if(_.selectedIndex>0){const e=this.data.roles[_.selectedIndex-1],t=e.aptitudes;this.configData.roleSelected=e.role;for(let e=0;e<t.length;e++)this.selectedAptitudes.includes(t[e])?d.push(t[e]):this.selectedAptitudes.push(t[e])}else this.configData.roleSelected="";const m=document.getElementById("backgroundSelect");if(m.selectedIndex>0){const e=this.data.backgrounds[m.selectedIndex-1],t=e.aptitude;this.configData.backgroundSelected=e.background,this.selectedAptitudes.includes(t)?d.push(t):this.selectedAptitudes.push(t)}else this.configData.backgroundSelected="";const h=document.getElementById("aptitudeSelect");if(this.configData.extraAptitudesSelected=[],h.selectedIndex>=0){const e=h.selectedOptions;for(let t=0;t<e.length;t++){const s=this.data.optional[e[t].index];this.configData.extraAptitudesSelected.push(s),this.selectedAptitudes.includes(s)?d.push(s):this.selectedAptitudes.push(s)}}const p=document.getElementById("selectedAptitudes");p.innerHTML="";for(let e=0;e<this.selectedAptitudes.length;e++)p.innerHTML+="<span class='badge badge-pill badge-secondary "+this.selectedAptitudes[e].replace(" ","_")+"'>"+this.selectedAptitudes[e]+"</span>&nbsp;";for(let e=0;e<d.length;e++)p.innerHTML+="<span class='badge badge-pill badge-danger'>"+d[e]+" (duplicate)</span>";const f=document.getElementById("characteristic");f.innerHTML="";const g=this.data.characteristic.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.name)&&s++,this.selectedAptitudes.includes(e.aptitude)&&s++;let n=0;return this.selectedAptitudes.includes(t.name)&&n++,this.selectedAptitudes.includes(t.aptitude)&&n++,n-s}));for(let e=0;e<g.length;e++){if(0!=i.length&&!i.includes(g[e].name.toLowerCase().trim()))continue;const t=document.createElement("div"),s=document.createElement("div");let n=!1;for(let r=0;r<this.data.costs.length;r++)if("characteristic"===this.data.costs[r].type){let o=0;this.selectedAptitudes.includes(g[e].name)&&o++,this.selectedAptitudes.includes(g[e].aptitude)&&o++,n=this.calcSkipAndSetMatchCount(t,r,o,s,c,n)}if(n)continue;const r=document.createElement("div");f.appendChild(r),r.appendChild(t),r.appendChild(s);const o=document.createElement("div");o.innerHTML=g[e].name,this.selectedAptitudes.includes(g[e].name)&&o.classList.add("m2"),r.appendChild(o);const a=document.createElement("div");a.innerHTML=g[e].aptitude,this.selectedAptitudes.includes(g[e].aptitude)&&a.classList.add("m2"),r.appendChild(a)}const v=document.getElementById("talent");v.innerHTML="";const P=this.data.talents.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.apt1)&&s++,this.selectedAptitudes.includes(e.apt2)&&s++;let n=0;return this.selectedAptitudes.includes(t.apt1)&&n++,this.selectedAptitudes.includes(t.apt2)&&n++,s===n?e.tier-t.tier:n-s}));for(let e=0;e<P.length;e++){if(0!=s.length&&!s.includes(P[e].talent.toLowerCase().trim()))continue;const t=document.createElement("div");t.setAttribute("data-export","true");const n=document.createElement("div");n.setAttribute("data-export","true");let r=!1;for(let s=0;s<this.data.costs.length;s++)if("talent"===this.data.costs[s].type){let o=0;this.selectedAptitudes.includes(P[e].apt1)&&o++,this.selectedAptitudes.includes(P[e].apt2)&&o++,t.innerHTML=""+this.data.costs[s].cost[2-o][P[e].tier-1],t.classList.add("m"+o),n.innerHTML=""+o,n.classList.add("m"+o),0===o&&c&&(r=!0)}if(r)continue;const o=document.createElement("div");v.appendChild(o),o.appendChild(t),o.appendChild(n);const i=document.createElement("div");i.setAttribute("data-export","true"),i.innerHTML="T"+P[e].tier,o.appendChild(i);const a=document.createElement("div");a.setAttribute("data-export","true"),a.innerHTML=P[e].talent,o.appendChild(a),a.title=P[e].benefit,a.id=P[e].talent,P[e].ref&&(a.title+=" ( "+P[e].ref.replace("PG","").trim()+" )");const d=document.createElement("div");d.setAttribute("data-export","true"),d.innerHTML=P[e].apt1,o.appendChild(d),this.selectedAptitudes.includes(P[e].apt1)&&d.classList.add("m2");const l=document.createElement("div");l.setAttribute("data-export","true"),l.innerHTML=P[e].apt2,o.appendChild(l),this.selectedAptitudes.includes(P[e].apt2)&&l.classList.add("m2");const u=document.createElement("div");u.setAttribute("data-export",P[e].prerequisites),this.replacePrerequisites(P[e],u,P[e].prerequisites),o.appendChild(u);const _=document.createElement("div");_.setAttribute("data-export","true"),_.innerHTML=P[e].benefit,_.style.display="none",o.appendChild(_);const m=document.createElement("div");m.setAttribute("data-export","false");const h=this.fullTree.get(P[e].talent),p=[];if(h&&h.parents.length>0){this.fullTree.iterateParents(h).forEach((e=>{if(e.data&&e.data.prerequisites&&"—"!=e.data.prerequisites&&"-"!=e.data.prerequisites){const t=this.splitPrerequisites(e.data.prerequisites);for(let e=0;e<t.length;e++)p.push(t[e])}}));{const t=this.splitPrerequisites(P[e].prerequisites);for(let e=0;e<t.length;e++)p.push(t[e])}}let f=null;if(p.length>0){const e=[],t=[],s=[];p.forEach((n=>{let r=!1;if(this.data.characteristic.forEach((t=>{const s=new RegExp("^"+t.name+" (\\d+)$","i");if(s.test(n)){const o=parseInt(n.match(s)[1]),i=e.filter((e=>e.characteristic.name===t.name));if(i.length>0){const e=i[0];e.amount<o&&(e.amount=o)}else e.push({characteristic:t,amount:o});r=!0}})),this.data.skills.forEach((e=>{const s=new RegExp("^"+e.name+" \\((.+)\\) \\+(\\d+)$","i"),o=new RegExp("^"+e.name+" \\+(\\d+)$","i");let i=null,a=null;if(s.test(n)?(i=parseInt(n.match(s)[2]),a=n.match(s)[1],r=!0):o.test(n)&&(i=parseInt(n.match(o)[1]),r=!0),null!=i){const s=t.filter((t=>t.skill.name===e.name&&t.choice===a));if(s.length>0){const e=s[0];e.amount<i&&(e.amount=i)}else t.push({skill:e,choice:a,amount:i})}})),!r){const e=`${n}`;-1===s.indexOf(e)&&s.push(e)}})),s.sort(((e,t)=>e.localeCompare(t))),e.sort(((e,t)=>e.characteristic.name.localeCompare(t.characteristic.name))).forEach((e=>{s.push(`<i>Char</i>: ${e.characteristic.name} ${e.amount}`)})),t.sort(((e,t)=>e.skill.name.localeCompare(t.skill.name))).forEach((e=>{e.choice?s.push(`<i>Skill</i>: ${e.skill.name} (${e.choice}) +${e.amount}`):s.push(`<i>Skill</i>: ${e.skill.name} ${e.amount}`)}));let n="<b>All Prerequisites</b>:<br><ul class='tiny-ul'>";for(let e=0;e<s.length;e++)n+="<li>"+s[e]+"</li>";n+="</ul>",f=this.randomStr(10);const r=`\n\t\t\t\t<button id="${f}" type="button" class="unstyled-button" data-container="body" data-toggle="popover" data-placement="left" data-content="${n}">\n\t\t\t\t\t<i class='icon-as-button fa-regular fa-eye'></i>\n\t\t\t\t</button>\n\t\t\t\t`;""!==n&&(m.innerHTML=r)}o.appendChild(m),null!=f&&$("#"+f).popover({trigger:"focus",html:!0})}const B=document.getElementById("skill");B.innerHTML="";const b=this.data.skills.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.aptitudes[0])&&s++,this.selectedAptitudes.includes(e.aptitudes[1])&&s++;let n=0;return this.selectedAptitudes.includes(t.aptitudes[0])&&n++,this.selectedAptitudes.includes(t.aptitudes[1])&&n++,n-s}));for(let e=0;e<b.length;e++){if(0!=r.length&&!r.includes(b[e].name.toLowerCase().trim()))continue;const t=document.createElement("div"),s=document.createElement("div");let n=!1;for(let r=0;r<this.data.costs.length;r++)if("skill"===this.data.costs[r].type){let o=0;this.selectedAptitudes.includes(b[e].aptitudes[0])&&o++,this.selectedAptitudes.includes(b[e].aptitudes[1])&&o++,n=this.calcSkipAndSetMatchCount(t,r,o,s,c,n)}if(n)continue;const o=document.createElement("div");B.appendChild(o),o.appendChild(t),o.appendChild(s);const i=document.createElement("div");i.innerHTML=b[e].name,o.appendChild(i);for(let t=0;t<b[e].aptitudes.length;t++){const s=document.createElement("div");s.innerHTML=b[e].aptitudes[t],this.selectedAptitudes.includes(b[e].aptitudes[t])&&s.classList.add("m2"),o.appendChild(s)}}this.buildSelectedTree(),$("[title]:not(.dropdown-toggle)").tooltip(),this.save()}buildSelectedTree(){const e=this.tree;e.buildTree(!0);const t={name:e.rootNode.name,parent:null,children:[]};!function e(t,s){t.children.forEach((n=>{const r={name:n.name,parent:t.name,children:[],data:n.data};s.children.push(r),e(n,r)}))}(e.rootNode,t),drawChart("selectedTree",t,e.nodeCount)}splitPrerequisites(e){return e.split(/,(?![^()]*\))/).map((e=>e.trim()))}replacePrerequisites(e,t,s){if("—"==s||"-"==s){const e=document.createElement("span");return e.innerHTML="—",t.appendChild(e),!1}const n=document.createElement("ul");let r=!1;const o=this.splitPrerequisites(s);for(let t=0;t<o.length;t++){const s=o[t].trim(),i=document.createElement("li"),a=s.toLowerCase(),c=[],d=[];if(this.data.talents.forEach((t=>{const s=a.indexOf(t.talent.toLowerCase());if(s>=0&&!d.includes(t.talent)){d.push(t.talent),c.push({from:s,to:t.talent.length,talent:t});const n=this.tree.getOrCreate(t.talent);n.data=t;const r=this.tree.getOrCreate(e.talent);r.data=e,this.tree.linkParentToChild(n,r)}})),c.length>0){c.sort(((e,t)=>e.from-t.from));let e=0;for(;e<s.length;)if(c.length>0&&c[0].from==e){const t=document.createElement("span");t.classList.add("jump-to-anchor"),t.setAttribute("title",c[0].talent.benefit);const s=c[0].talent.talent;t.innerText=s,t.setAttribute("data-talent",s),t.onclick=()=>this.scrollToAnchor(s),i.appendChild(t),e+=c[0].to,c.shift(),r=!0}else if(c.length>0){const t=document.createElement("span");t.innerText=s.substring(e,c[0].from),i.appendChild(t),e=c[0].from}else{const t=document.createElement("span");t.innerText=s.substring(e),i.appendChild(t),e=s.length}}else i.innerText=s;n.appendChild(i)}return t.appendChild(n),r}save(){const t=JSON.stringify(this.configData);console.log("save","w40k-data-config-"+this.source,t),localStorage.setItem("w40k-data-config-"+this.source,t);const s=function(t,{mode:s=7,enableEndMark:n=!0}={}){const r=Te(t,{mode:s,enableEndMark:n});return o=new Uint8Array(r),encodeURIComponent(function(t){for(var s,n=(3-t.length%3)%3,r="",o=t.length,i=0,a=0;a<o;a++)s=a%3,i|=t[a]<<(16>>>s&24),2!==s&&t.length-a!=1||(r+=String.fromCharCode(e(i>>>18&63),e(i>>>12&63),e(i>>>6&63),e(63&i)),i=0);return 0===n?r:r.substring(0,r.length-n)+(1===n?"=":"==")}(o).replace(/\+/g,"-").replace(/\//g,"_"));var o}(t),n=encodeURIComponent(t);document.getElementById("saveLink").href="?source="+this.source+"&cfg="+n,document.getElementById("saveLinkAlt").href="?source="+this.source+"&cfg="+s}calcSkipAndSetMatchCount(e,t,s,n,r,o){return e.innerHTML=""+this.data.costs[t].cost[2-s][0],e.classList.add("m"+s),n.innerHTML=""+s,n.classList.add("m"+s),0===s&&r&&(o=!0),o}exportAllTableToExcelDef(e,t,s){document.getElementById("exportTableToExcelDef")?.remove();const n=this.exportDivToTable(e),r=this.exportDivToTable(t),o=this.exportDivToTable(s);if(!n)return;if(!r)return;if(!o)return;const i=document.createElement("div");i.innerHTML="<table><tr><td>Characteristics</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>skill</td>\n\t\t<td>aptitude</td>\n\t</tr>"+n.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Skills</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>characteristic</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t</tr>"+r.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Talents</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>tier</td>\n\t\t<td>talent</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t\t<td>requirement</td>\n\t\t<td>description</td>\n\t</tr>"+o.replace("<table>","").replace("</table>","")+"</table>",i.style.display="none",i.id="exportTableToExcelDef",document.body.appendChild(i),this.exportTableToExcel("exportTableToExcelDef","all")}exportTableToExcelDef(e){const t="exportTableToExcelDef_";document.getElementById(t)?.remove();const s=this.exportDivToTable(e);if(!s)return;const n=document.createElement("div");n.innerHTML=s,n.style.display="none",n.id=t,document.body.appendChild(n),this.exportTableToExcel(n.id,e)}exportDivToTable(e,t=!1){const s=document.getElementById(e);if(!s)return;let n="";t||(n+="<table>");for(let e=0;e<s.children.length;e++){t||(n+="<tr>");const r=s.children[e];for(let e=0;e<r.children.length;e++){const s=r.children[e],o=s.getAttribute("data-export");"false"!==o&&(t||(n+="<td>"),n+="true"===o||null===o?s.innerHTML:o,n+=t?"\t":"</td>")}n+=t?"\n":"</tr>"}return t||(n+="</table>"),n}exportTableToExcel(e,t=""){const s="application/vnd.ms-excel",n=document.getElementById(e);if(!n)return;const r=n.outerHTML.replace(/ /g,"%20");t=t?t+".html.xls":"w40k.html.xls",document.getElementById("downloadLinkId")?.remove();const o=document.createElement("a");if(o.id="downloadLinkId",document.body.appendChild(o),navigator.msSaveOrOpenBlob){const e=new Blob(["\ufeff",r],{type:s});navigator.msSaveOrOpenBlob(e,t)}else o.href="data:"+s+", "+r,o.download=t,o.click()}copyToClipboardText(e){const t=this.exportDivToTable(e,!0);if(!t)return;const s="1_textarea_copy_";document.getElementById(s+e)?.remove();const n=document.createElement("textarea");n.innerHTML=t,n.style.display="none",n.id=s+e,document.body.appendChild(n),n.select(),n.setSelectionRange(0,99999),navigator.clipboard.writeText(n.value)}copyToClipboardWishlist(e,t){const s=document.getElementById(e);if(!s)return;let n="";for(let e=0;e<s.children.length;e++){const r=s.children[e],o=r.children[1],i="0"==o.innerHTML||"1"==o.innerHTML,a=r.children[t];i&&(n+=a.innerHTML+"\n")}const r="2_textarea_copy_"+e;document.getElementById(r)?.remove();const o=document.createElement("textarea");o.innerHTML=n,o.style.display="none",o.id=r,document.body.appendChild(o),o.select(),o.setSelectionRange(0,99999),navigator.clipboard.writeText(o.value).then((()=>{}))}logMatchingWorlds(e,t){if(!t.worlds||0==t.worlds.length)return;const s=document.getElementById("aptitudeWishlistSelect");if(s.selectedIndex>=0){console.log("logMatchingWorlds");const e=s.selectedOptions,n=[],r=[];for(let t=0;t<e.length;t++)n.push(this.data.optional[e[t].index]);console.log(n);for(let e=0;e<t.worlds.length;e++){let s=0;for(let r=0;r<n.length;r++)t.worlds[e].aptitude==n[r]&&s++;r.push(new He(t.worlds[e],s))}r.sort(((e,t)=>t.matches-e.matches));for(let e=0;e<r.length;e++)console.log(r[e].world?.world,r[e].matches,r[e].world?.aptitude)}}logMatchingBackgrounds(e,t){if(!t.backgrounds||0==t.backgrounds.length)return;const s=document.getElementById("aptitudeWishlistSelect");if(s.selectedIndex>=0){console.log("logMatchingBackgrounds");const e=s.selectedOptions,n=[],r=[];for(let t=0;t<e.length;t++)n.push(this.data.optional[e[t].index]);console.log(n);for(let e=0;e<t.backgrounds.length;e++){let s=0;for(let r=0;r<n.length;r++)t.backgrounds[e].aptitude==n[r]&&s++;r.push(new Ne(t.backgrounds[e],s))}r.sort(((e,t)=>t.matches-e.matches));for(let e=0;e<r.length;e++)console.log(r[e].background?.background,r[e].matches,r[e].background?.aptitude)}}logMatchingRoles(e,t){if(!t.roles||0==t.roles.length)return;const s=document.getElementById("aptitudeWishlistSelect");if(s.selectedIndex>=0){console.log("logMatchingRoles");const e=s.selectedOptions,n=[],r=[];for(let t=0;t<e.length;t++)n.push(this.data.optional[e[t].index]);console.log(n);for(let e=0;e<t.roles.length;e++){let s=0;for(let r=0;r<t.roles[e].aptitudes.length;r++)for(let o=0;o<n.length;o++)t.roles[e].aptitudes[r]==n[o]&&s++;r.push(new Oe(t.roles[e],s))}r.sort(((e,t)=>t.matches-e.matches));for(let e=0;e<r.length;e++)console.log(r[e].role?.role,r[e].matches,r[e].role?.aptitudes)}}logMatchingClasses(e,t){if(!t.classes||0==t.classes.length)return;const s=document.getElementById("aptitudeWishlistSelect");if(s.selectedIndex>=0){console.log("logMatchingClasses");const e=s.selectedOptions,n=[],r=[];for(let t=0;t<e.length;t++)n.push(this.data.optional[e[t].index]);console.log(n);for(let e=0;e<t.classes.length;e++){let s=0;for(let r=0;r<t.classes[e].aptitudes.length;r++)for(let o=0;o<n.length;o++)t.classes[e].aptitudes[r]==n[o]&&s++;r.push(new ze(t.classes[e],s))}r.sort(((e,t)=>t.matches-e.matches));for(let e=0;e<r.length;e++)console.log(r[e].class?.class,r[e].matches,r[e].class?.aptitudes)}}styleAptitudeMatches(e,t){for(let e=0;e<t.optional.length;e++){const s=t.optional[e];let n=document.getElementById("style-"+s.replace(" ","_"));n||(n=document.createElement("style"),n.id="style-"+s.replace(" ","_"),n.innerHTML=".badge.badge-pill.badge-secondary."+s.replace(" ","_")+"{background-color:#1cc88a !important}",document.body.appendChild(n)),n.disabled=!0}const s=document.getElementById("aptitudeWishlistSelect");if(this.configData.aptitudesWishlist=[],s.selectedIndex>=0){const e=s.selectedOptions;for(let t=0;t<e.length;t++){const s=this.data.optional[e[t].index];this.configData.aptitudesWishlist.push(s),document.getElementById("style-"+s.replace(" ","_")).disabled=!1}}this.save()}randomStr(e){let t="";const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=s.length;let r=0;for(;r<e;)t+=s.charAt(Math.floor(Math.random()*n)),r+=1;return t}}).start()}();
//# sourceMappingURL=w40k.js.map