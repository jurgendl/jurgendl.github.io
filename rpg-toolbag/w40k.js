!function(){"use strict";var e;!function(e){e.General="General",e.Weapon_Skill="Weapon Skill",e.Ballistic_Skill="Ballistic Skill",e.Strength="Strength",e.Toughness="Toughness",e.Agility="Agility",e.Intelligence="Intelligence",e.Perception="Perception",e.Willpower="Willpower",e.Fellowship="Fellowship",e.Offence="Offence",e.Finesse="Finesse",e.Defence="Defence",e.Psyker="Psyker",e.Tech="Tech",e.Knowledge="Knowledge",e.Leadership="Leadership",e.Fieldcraft="Fieldcraft",e.Social="Social"}(e||(e={})),(new class{init(){fetch("assets/w40k.json").then((e=>e.json())).then((e=>this.app(e)))}data;selectedAptitudes=[];app(e){this.data=e;const t=document.getElementById("classSelect");{const e=document.createElement("option");e.text="None",t.add(e)}for(let e=0;e<this.data.classes.length;e++){const d=document.createElement("option");d.text=this.data.classes[e].class,d.value=this.data.classes[e].class,t.add(d)}t.addEventListener("change",(e=>{this.triggerRecalc(e)}));const d=document.getElementById("aptitudeSelect");{const e=document.createElement("option");e.text="None",d.add(e)}for(let e=0;e<this.data.optional.length;e++){const t=document.createElement("option");t.text=this.data.optional[e],t.value=this.data.optional[e],d.add(t)}d.addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("skip0Cb").addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("export_characteristic").addEventListener("click",(e=>{this.exportTableToExcelDef("characteristic")})),document.getElementById("export_skill").addEventListener("click",(e=>{this.exportTableToExcelDef("skill")})),document.getElementById("export_talent").addEventListener("click",(e=>{this.exportTableToExcelDef("talent")})),document.getElementById("export_all").addEventListener("click",(e=>{this.exportAllTableToExcelDef("characteristic","skill","talent")})),this.triggerRecalc(null)}triggerRecalc(e){this.selectedAptitudes=[];const t=document.getElementById("skip0Cb").checked;this.selectedAptitudes.push(this.data.free),console.log("free",this.data.free);const d=document.getElementById("classSelect");if(d.selectedIndex>0){const e=this.data.classes[d.selectedIndex-1].aptitudes;for(let t=0;t<e.length;t++)this.selectedAptitudes.push(e[t]),console.log("class",d.selectedIndex,t,e[t])}let n=null;const s=document.getElementById("aptitudeSelect");if(s.selectedIndex>0){const e=this.data.optional[s.selectedIndex-1];this.selectedAptitudes.includes(e)?n=e:(this.selectedAptitudes.push(e),console.log("apt",s.selectedIndex,e))}const l=document.getElementById("selectedAptitudes");console.log(this.selectedAptitudes),l.innerHTML="<u>Aptitudes</u>: ";for(let e=0;e<this.selectedAptitudes.length;e++)l.innerHTML+="<span class='badge badge-secondary'>"+this.selectedAptitudes[e]+"</span>&nbsp;";n&&(l.innerHTML+="<span class='badge badge-danger'>"+n+" (duplicate)</span>");const i=document.getElementById("characteristic");i.innerHTML="";const c=this.data.characteristic.sort(((e,t)=>{let d=0;this.selectedAptitudes.includes(e.name)&&d++,this.selectedAptitudes.includes(e.aptitude)&&d++;let n=0;return this.selectedAptitudes.includes(t.name)&&n++,this.selectedAptitudes.includes(t.aptitude)&&n++,-d+n}));for(let e=0;e<c.length;e++){const d=document.createElement("div"),n=document.createElement("div");let s=!1;for(let l=0;l<this.data.costs.length;l++)if("characteristic"===this.data.costs[l].type){let i=0;this.selectedAptitudes.includes(c[e].name)&&i++,this.selectedAptitudes.includes(c[e].aptitude)&&i++,d.innerHTML=""+this.data.costs[l].cost[2-i][0],d.classList.add("m"+i),n.innerHTML=""+i,n.classList.add("m"+i),0===i&&t&&(s=!0)}if(s)continue;const l=document.createElement("div");i.appendChild(l),l.appendChild(d),l.appendChild(n);const a=document.createElement("div");a.innerHTML=c[e].name,this.selectedAptitudes.includes(c[e].name)&&a.classList.add("m2"),l.appendChild(a);const o=document.createElement("div");o.innerHTML=c[e].aptitude,this.selectedAptitudes.includes(c[e].aptitude)&&o.classList.add("m2"),l.appendChild(o)}const a=document.getElementById("talent");a.innerHTML="";const o=this.data.talents.sort(((e,t)=>{let d=0;this.selectedAptitudes.includes(e.apt1)&&d++,this.selectedAptitudes.includes(e.apt2)&&d++;let n=0;return this.selectedAptitudes.includes(t.apt1)&&n++,this.selectedAptitudes.includes(t.apt2)&&n++,d===n?e.tier-t.tier:-d+n}));for(let e=0;e<o.length;e++){const d=document.createElement("div"),n=document.createElement("div");let s=!1;for(let l=0;l<this.data.costs.length;l++)if("talent"===this.data.costs[l].type){let i=0;this.selectedAptitudes.includes(o[e].apt1)&&i++,this.selectedAptitudes.includes(o[e].apt2)&&i++,d.innerHTML=""+this.data.costs[l].cost[2-i][o[e].tier-1],d.classList.add("m"+i),n.innerHTML=""+i,n.classList.add("m"+i),0===i&&t&&(s=!0)}if(s)continue;const l=document.createElement("div");a.appendChild(l),l.appendChild(d),l.appendChild(n);const i=document.createElement("div");i.innerHTML="T"+o[e].tier,l.appendChild(i);const c=document.createElement("div");c.innerHTML=o[e].talent,l.appendChild(c),c.title=o[e].benefit;const r=document.createElement("div");r.innerHTML=o[e].apt1,l.appendChild(r),this.selectedAptitudes.includes(o[e].apt1)&&r.classList.add("m2");const p=document.createElement("div");p.innerHTML=o[e].apt2,l.appendChild(p),this.selectedAptitudes.includes(o[e].apt2)&&p.classList.add("m2");const u=document.createElement("div");u.innerHTML=o[e].prerequisites,l.appendChild(u);const h=document.createElement("div");h.innerHTML=o[e].benefit,h.style.display="none",l.appendChild(h)}const r=document.getElementById("skill");r.innerHTML="";const p=this.data.skills.sort(((e,t)=>{let d=0;this.selectedAptitudes.includes(e.aptitudes[0])&&d++,this.selectedAptitudes.includes(e.aptitudes[1])&&d++;let n=0;return this.selectedAptitudes.includes(t.aptitudes[0])&&n++,this.selectedAptitudes.includes(t.aptitudes[1])&&n++,-d+n}));for(let e=0;e<p.length;e++){let d=!1;const n=document.createElement("div"),s=document.createElement("div");for(let l=0;l<this.data.costs.length;l++)if("skill"===this.data.costs[l].type){let i=0;this.selectedAptitudes.includes(p[e].aptitudes[0])&&i++,this.selectedAptitudes.includes(p[e].aptitudes[1])&&i++,n.innerHTML=""+this.data.costs[l].cost[2-i][0],n.classList.add("m"+i),s.innerHTML=""+i,s.classList.add("m"+i),0===i&&t&&(d=!0)}if(d)continue;const l=document.createElement("div");r.appendChild(l),l.appendChild(n),l.appendChild(s);const i=document.createElement("div");i.innerHTML=p[e].name,l.appendChild(i);for(let t=0;t<p[e].aptitudes.length;t++){const d=document.createElement("div");d.innerHTML=p[e].aptitudes[t],this.selectedAptitudes.includes(p[e].aptitudes[t])&&d.classList.add("m2"),l.appendChild(d)}}}exportAllTableToExcelDef(e,t,d){document.getElementById("exportTableToExcelDef")?.remove();const n=this.exportDivToTable(e),s=this.exportDivToTable(t),l=this.exportDivToTable(d);if(!n)return;if(!s)return;if(!l)return;const i=document.createElement("div");i.innerHTML="<table><tr><td>Characteristics</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>skill</td>\n\t\t<td>aptitude</td>\n\t</tr>"+n.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Skills</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>characteristic</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t</tr>"+s.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Talents</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>tier</td>\n\t\t<td>talent</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t\t<td>requirement</td>\n\t\t<td>description</td>\n\t</tr>"+l.replace("<table>","").replace("</table>","")+"</table>",i.style.display="none",i.id="exportTableToExcelDef",document.body.appendChild(i),this.exportTableToExcel("exportTableToExcelDef","all")}exportTableToExcelDef(e){document.getElementById("exportTableToExcelDef")?.remove();const t=this.exportDivToTable(e);if(!t)return;const d=document.createElement("div");d.innerHTML=t,d.style.display="none",d.id="exportTableToExcelDef",document.body.appendChild(d),this.exportTableToExcel("exportTableToExcelDef",e)}exportDivToTable(e){const t=document.getElementById(e);if(!t)return;let d="<table>";for(let e=0;e<t.children.length;e++){d+="<tr>";const n=t.children[e];for(let e=0;e<n.children.length;e++)d+="<td>",d+=n.children[e].innerHTML,d+="</td>";d+="</tr>"}return d+="</table>",d}exportTableToExcel(e,t=""){const d="application/vnd.ms-excel",n=document.getElementById(e);if(!n)return;const s=n.outerHTML.replace(/ /g,"%20");t=t?t+".xls":"excel_data.xls";const l=document.createElement("a");if(document.body.appendChild(l),navigator.msSaveOrOpenBlob){const e=new Blob(["\ufeff",s],{type:d});navigator.msSaveOrOpenBlob(e,t)}else l.href="data:"+d+", "+s,l.download=t,l.click()}}).init()}();
//# sourceMappingURL=w40k.js.map