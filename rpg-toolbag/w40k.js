!function(){"use strict";var e;!function(e){e.General="General",e.Weapon_Skill="Weapon Skill",e.Ballistic_Skill="Ballistic Skill",e.Strength="Strength",e.Toughness="Toughness",e.Agility="Agility",e.Intelligence="Intelligence",e.Perception="Perception",e.Willpower="Willpower",e.Fellowship="Fellowship",e.Offence="Offence",e.Finesse="Finesse",e.Defence="Defence",e.Psyker="Psyker",e.Tech="Tech",e.Knowledge="Knowledge",e.Leadership="Leadership",e.Fieldcraft="Fieldcraft",e.Social="Social"}(e||(e={})),(new class{init(){fetch("assets/w40k.json").then((e=>e.json())).then((e=>this.app(e)))}data;selectedAptitudes=[];app(e){this.data=e;const t=document.getElementById("classSelect");{const e=document.createElement("option");e.text="None",t.add(e)}for(let e=0;e<this.data.classes.length;e++){const n=document.createElement("option");n.text=this.data.classes[e].class,n.value=this.data.classes[e].class,t.add(n)}t.addEventListener("change",(e=>{this.triggerRecalc(e)}));const n=document.getElementById("aptitudeSelect");{const e=document.createElement("option");e.text="None",n.add(e)}for(let e=0;e<this.data.optional.length;e++){const t=document.createElement("option");t.text=this.data.optional[e],t.value=this.data.optional[e],n.add(t)}n.addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("skip0Cb").addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("wishlist").addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("export_characteristic").addEventListener("click",(e=>{this.copyToClipboard("characteristic")})),document.getElementById("export_skill").addEventListener("click",(e=>{this.copyToClipboard("skill")})),document.getElementById("export_talent").addEventListener("click",(e=>{this.copyToClipboard("talent")})),document.getElementById("export_all").addEventListener("click",(e=>{this.exportAllTableToExcelDef("characteristic","skill","talent")})),this.triggerRecalc(null)}triggerRecalc(e){const t=document.getElementById("wishlist").value.split("\n");for(let e=0;e<t.length;e++)""===t[e]&&(t.splice(e,1),e--);for(let e=0;e<t.length;e++)t[e]=t[e].toLowerCase().trim();console.log("wishlistArray",t.length,t),this.selectedAptitudes=[];const n=document.getElementById("skip0Cb").checked;this.selectedAptitudes.push(this.data.free),console.log("free",this.data.free);const d=document.getElementById("classSelect");if(d.selectedIndex>0){const e=this.data.classes[d.selectedIndex-1].aptitudes;for(let t=0;t<e.length;t++)this.selectedAptitudes.push(e[t]),console.log("class",d.selectedIndex,t,e[t])}let s=null;const l=document.getElementById("aptitudeSelect");if(l.selectedIndex>0){const e=this.data.optional[l.selectedIndex-1];this.selectedAptitudes.includes(e)?s=e:(this.selectedAptitudes.push(e),console.log("apt",l.selectedIndex,e))}const i=document.getElementById("selectedAptitudes");console.log(this.selectedAptitudes),i.innerHTML="<u>Aptitudes</u>: ";for(let e=0;e<this.selectedAptitudes.length;e++)i.innerHTML+="<span class='badge badge-secondary'>"+this.selectedAptitudes[e]+"</span>&nbsp;";s&&(i.innerHTML+="<span class='badge badge-danger'>"+s+" (duplicate)</span>");const c=document.getElementById("characteristic");c.innerHTML="";const a=this.data.characteristic.sort(((e,t)=>{let n=0;this.selectedAptitudes.includes(e.name)&&n++,this.selectedAptitudes.includes(e.aptitude)&&n++;let d=0;return this.selectedAptitudes.includes(t.name)&&d++,this.selectedAptitudes.includes(t.aptitude)&&d++,-n+d}));for(let e=0;e<a.length;e++){const t=document.createElement("div"),d=document.createElement("div");let s=!1;for(let l=0;l<this.data.costs.length;l++)if("characteristic"===this.data.costs[l].type){let i=0;this.selectedAptitudes.includes(a[e].name)&&i++,this.selectedAptitudes.includes(a[e].aptitude)&&i++,t.innerHTML=""+this.data.costs[l].cost[2-i][0],t.classList.add("m"+i),d.innerHTML=""+i,d.classList.add("m"+i),0===i&&n&&(s=!0)}if(s)continue;const l=document.createElement("div");c.appendChild(l),l.appendChild(t),l.appendChild(d);const i=document.createElement("div");i.innerHTML=a[e].name,this.selectedAptitudes.includes(a[e].name)&&i.classList.add("m2"),l.appendChild(i);const o=document.createElement("div");o.innerHTML=a[e].aptitude,this.selectedAptitudes.includes(a[e].aptitude)&&o.classList.add("m2"),l.appendChild(o)}const o=document.getElementById("talent");o.innerHTML="";const r=this.data.talents.sort(((e,t)=>{let n=0;this.selectedAptitudes.includes(e.apt1)&&n++,this.selectedAptitudes.includes(e.apt2)&&n++;let d=0;return this.selectedAptitudes.includes(t.apt1)&&d++,this.selectedAptitudes.includes(t.apt2)&&d++,n===d?e.tier-t.tier:-n+d}));for(let e=0;e<r.length;e++){if(console.log(r[e].talent.toLowerCase(),0==t.length,t.includes(r[e].talent.toLowerCase())),0!=t.length&&!t.includes(r[e].talent.toLowerCase().trim()))continue;const d=document.createElement("div"),s=document.createElement("div");let l=!1;for(let t=0;t<this.data.costs.length;t++)if("talent"===this.data.costs[t].type){let i=0;this.selectedAptitudes.includes(r[e].apt1)&&i++,this.selectedAptitudes.includes(r[e].apt2)&&i++,d.innerHTML=""+this.data.costs[t].cost[2-i][r[e].tier-1],d.classList.add("m"+i),s.innerHTML=""+i,s.classList.add("m"+i),0===i&&n&&(l=!0)}if(l)continue;const i=document.createElement("div");o.appendChild(i),i.appendChild(d),i.appendChild(s);const c=document.createElement("div");c.innerHTML="T"+r[e].tier,i.appendChild(c);const a=document.createElement("div");a.innerHTML=r[e].talent,i.appendChild(a),a.title=r[e].benefit;const p=document.createElement("div");p.innerHTML=r[e].apt1,i.appendChild(p),this.selectedAptitudes.includes(r[e].apt1)&&p.classList.add("m2");const u=document.createElement("div");u.innerHTML=r[e].apt2,i.appendChild(u),this.selectedAptitudes.includes(r[e].apt2)&&u.classList.add("m2");const h=document.createElement("div");h.innerHTML=r[e].prerequisites,i.appendChild(h);const m=document.createElement("div");m.innerHTML=r[e].benefit,m.style.display="none",i.appendChild(m)}const p=document.getElementById("skill");p.innerHTML="";const u=this.data.skills.sort(((e,t)=>{let n=0;this.selectedAptitudes.includes(e.aptitudes[0])&&n++,this.selectedAptitudes.includes(e.aptitudes[1])&&n++;let d=0;return this.selectedAptitudes.includes(t.aptitudes[0])&&d++,this.selectedAptitudes.includes(t.aptitudes[1])&&d++,-n+d}));for(let e=0;e<u.length;e++){let t=!1;const d=document.createElement("div"),s=document.createElement("div");for(let l=0;l<this.data.costs.length;l++)if("skill"===this.data.costs[l].type){let i=0;this.selectedAptitudes.includes(u[e].aptitudes[0])&&i++,this.selectedAptitudes.includes(u[e].aptitudes[1])&&i++,d.innerHTML=""+this.data.costs[l].cost[2-i][0],d.classList.add("m"+i),s.innerHTML=""+i,s.classList.add("m"+i),0===i&&n&&(t=!0)}if(t)continue;const l=document.createElement("div");p.appendChild(l),l.appendChild(d),l.appendChild(s);const i=document.createElement("div");i.innerHTML=u[e].name,l.appendChild(i);for(let t=0;t<u[e].aptitudes.length;t++){const n=document.createElement("div");n.innerHTML=u[e].aptitudes[t],this.selectedAptitudes.includes(u[e].aptitudes[t])&&n.classList.add("m2"),l.appendChild(n)}}}exportAllTableToExcelDef(e,t,n){document.getElementById("exportTableToExcelDef")?.remove();const d=this.exportDivToTable(e),s=this.exportDivToTable(t),l=this.exportDivToTable(n);if(!d)return;if(!s)return;if(!l)return;const i=document.createElement("div");i.innerHTML="<table><tr><td>Characteristics</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>skill</td>\n\t\t<td>aptitude</td>\n\t</tr>"+d.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Skills</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>characteristic</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t</tr>"+s.replace("<table>","").replace("</table>","")+"<tr><td> </td></tr><tr><td> </td></tr><tr><td>Talents</td></tr>\t<tr>\n\t\t<td>cost</td>\n\t\t<td>m</td>\n\t\t<td>tier</td>\n\t\t<td>talent</td>\n\t\t<td>aptitude</td>\n\t\t<td>aptitude</td>\n\t\t<td>requirement</td>\n\t\t<td>description</td>\n\t</tr>"+l.replace("<table>","").replace("</table>","")+"</table>",i.style.display="none",i.id="exportTableToExcelDef",document.body.appendChild(i),this.exportTableToExcel("exportTableToExcelDef","all")}exportTableToExcelDef(e){document.getElementById("exportTableToExcelDef")?.remove();const t=this.exportDivToTable(e);if(!t)return;const n=document.createElement("div");n.innerHTML=t,n.style.display="none",n.id="exportTableToExcelDef",document.body.appendChild(n),this.exportTableToExcel("exportTableToExcelDef",e)}exportDivToTable(e,t=!1){const n=document.getElementById(e);if(!n)return;let d="";t||(d+="<table>");for(let e=0;e<n.children.length;e++){t||(d+="<tr>");const s=n.children[e];for(let e=0;e<s.children.length;e++)t||(d+="<td>"),d+=s.children[e].innerHTML,d+=t?"\t":"</td>";d+=t?"\n":"</tr>"}return t||(d+="</table>"),d}exportTableToExcel(e,t=""){const n="application/vnd.ms-excel",d=document.getElementById(e);if(!d)return;const s=d.outerHTML.replace(/ /g,"%20");t=t?t+".xls":"excel_data.xls";const l=document.createElement("a");if(document.body.appendChild(l),navigator.msSaveOrOpenBlob){const e=new Blob(["\ufeff",s],{type:n});navigator.msSaveOrOpenBlob(e,t)}else l.href="data:"+n+", "+s,l.download=t,l.click()}copyToClipboard(e){document.getElementById("exportTableToClipboard")?.remove();const t=this.exportDivToTable(e,!0);if(!t)return;const n=document.createElement("textarea");n.innerHTML=t,n.style.display="none",n.id="exportTableToClipboard",document.body.appendChild(n),n.select(),n.setSelectionRange(0,99999),console.log(n.value),navigator.clipboard.writeText(n.value)}}).init()}();
//# sourceMappingURL=w40k.js.map