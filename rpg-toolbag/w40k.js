!function(){"use strict";var e;!function(e){e.General="General",e.Weapon_Skill="Weapon Skill",e.Ballistic_Skill="Ballistic Skill",e.Strength="Strength",e.Toughness="Toughness",e.Agility="Agility",e.Intelligence="Intelligence",e.Perception="Perception",e.Willpower="Willpower",e.Fellowship="Fellowship",e.Offence="Offence",e.Finesse="Finesse",e.Defence="Defence",e.Psyker="Psyker",e.Tech="Tech",e.Knowledge="Knowledge",e.Leadership="Leadership",e.Fieldcraft="Fieldcraft",e.Social="Social"}(e||(e={})),(new class{init(){fetch("assets/w40k.json").then((e=>e.json())).then((e=>this.app(e)))}data;selectedAptitudes=[];app(e){this.data=e;const t=document.getElementById("classSelect");{const e=document.createElement("option");e.text="None",t.add(e)}for(let e=0;e<this.data.classes.length;e++){const s=document.createElement("option");s.text=this.data.classes[e].class,s.value=this.data.classes[e].class,t.add(s)}t.addEventListener("change",(e=>{this.triggerRecalc(e)}));const s=document.getElementById("aptitudeSelect");{const e=document.createElement("option");e.text="None",s.add(e)}for(let e=0;e<this.data.optional.length;e++){const t=document.createElement("option");t.text=this.data.optional[e],t.value=this.data.optional[e],s.add(t)}s.addEventListener("change",(e=>{this.triggerRecalc(e)})),document.getElementById("export_characteristic").addEventListener("click",(e=>{this.exportTableToExcelDef("characteristic")})),document.getElementById("export_skill").addEventListener("click",(e=>{this.exportTableToExcelDef("skill")})),document.getElementById("export_talent").addEventListener("click",(e=>{this.exportTableToExcelDef("talent")})),this.triggerRecalc(null)}triggerRecalc(e){this.selectedAptitudes=[],this.selectedAptitudes.push(this.data.free),console.log("free",this.data.free);const t=document.getElementById("classSelect");if(t.selectedIndex>0){const e=this.data.classes[t.selectedIndex-1].aptitudes;for(let s=0;s<e.length;s++)this.selectedAptitudes.push(e[s]),console.log("class",t.selectedIndex,s,e[s])}let s=null;const n=document.getElementById("aptitudeSelect");if(n.selectedIndex>0){const e=this.data.optional[n.selectedIndex-1];this.selectedAptitudes.includes(e)?s=e:(this.selectedAptitudes.push(e),console.log("apt",n.selectedIndex,e))}const d=document.getElementById("selectedAptitudes");console.log(this.selectedAptitudes),d.innerHTML="<u>Aptitudes</u>: ";for(let e=0;e<this.selectedAptitudes.length;e++)d.innerHTML+="<span class='badge badge-secondary'>"+this.selectedAptitudes[e]+"</span>&nbsp;";s&&(d.innerHTML+="<span class='badge badge-danger'>"+s+" (duplicate)</span>");const i=document.getElementById("characteristic");i.innerHTML="";const l=this.data.characteristic.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.name)&&s++,this.selectedAptitudes.includes(e.aptitude)&&s++;let n=0;return this.selectedAptitudes.includes(t.name)&&n++,this.selectedAptitudes.includes(t.aptitude)&&n++,-s+n}));for(let e=0;e<l.length;e++){const t=document.createElement("div");i.appendChild(t);const s=document.createElement("div"),n=document.createElement("div");for(let t=0;t<this.data.costs.length;t++)if("characteristic"===this.data.costs[t].type){let d=0;this.selectedAptitudes.includes(l[e].name)&&d++,this.selectedAptitudes.includes(l[e].aptitude)&&d++,s.innerHTML=""+this.data.costs[t].cost[2-d][0],s.classList.add("m"+d),n.innerHTML=""+d,n.classList.add("m"+d)}t.appendChild(s),t.appendChild(n);const d=document.createElement("div");d.innerHTML=l[e].name,this.selectedAptitudes.includes(l[e].name)&&d.classList.add("m2"),t.appendChild(d);const c=document.createElement("div");c.innerHTML=l[e].aptitude,this.selectedAptitudes.includes(l[e].aptitude)&&c.classList.add("m2"),t.appendChild(c)}const c=document.getElementById("talent");c.innerHTML="";const a=this.data.talents.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.apt1)&&s++,this.selectedAptitudes.includes(e.apt2)&&s++;let n=0;return this.selectedAptitudes.includes(t.apt1)&&n++,this.selectedAptitudes.includes(t.apt2)&&n++,-s+n}));for(let e=0;e<a.length;e++){const t=document.createElement("div");c.appendChild(t);const s=document.createElement("div"),n=document.createElement("div");for(let t=0;t<this.data.costs.length;t++)if("talent"===this.data.costs[t].type){let d=0;this.selectedAptitudes.includes(a[e].apt1)&&d++,this.selectedAptitudes.includes(a[e].apt2)&&d++,s.innerHTML=""+this.data.costs[t].cost[2-d][a[e].tier-1],s.classList.add("m"+d),n.innerHTML=""+d,n.classList.add("m"+d)}t.appendChild(s),t.appendChild(n);const d=document.createElement("div");d.innerHTML="T"+a[e].tier,t.appendChild(d);const i=document.createElement("div");i.innerHTML=a[e].talent,t.appendChild(i);const l=document.createElement("div");l.innerHTML=a[e].apt1,t.appendChild(l),this.selectedAptitudes.includes(a[e].apt1)&&l.classList.add("m2");const o=document.createElement("div");o.innerHTML=a[e].apt2,t.appendChild(o),this.selectedAptitudes.includes(a[e].apt2)&&o.classList.add("m2");const p=document.createElement("div");p.innerHTML=a[e].prerequisites,t.appendChild(p)}const o=document.getElementById("skill");o.innerHTML="";const p=this.data.skills.sort(((e,t)=>{let s=0;this.selectedAptitudes.includes(e.aptitudes[0])&&s++,this.selectedAptitudes.includes(e.aptitudes[1])&&s++;let n=0;return this.selectedAptitudes.includes(t.aptitudes[0])&&n++,this.selectedAptitudes.includes(t.aptitudes[1])&&n++,-s+n}));for(let e=0;e<p.length;e++){const t=document.createElement("div");o.appendChild(t);const s=document.createElement("div"),n=document.createElement("div");for(let t=0;t<this.data.costs.length;t++)if("skill"===this.data.costs[t].type){let d=0;this.selectedAptitudes.includes(p[e].aptitudes[0])&&d++,this.selectedAptitudes.includes(p[e].aptitudes[1])&&d++,s.innerHTML=""+this.data.costs[t].cost[2-d][0],s.classList.add("m"+d),n.innerHTML=""+d,n.classList.add("m"+d)}t.appendChild(s),t.appendChild(n);const d=document.createElement("div");d.innerHTML=p[e].name,t.appendChild(d);for(let s=0;s<p[e].aptitudes.length;s++){const n=document.createElement("div");n.innerHTML=p[e].aptitudes[s],this.selectedAptitudes.includes(p[e].aptitudes[s])&&n.classList.add("m2"),t.appendChild(n)}}}exportTableToExcelDef(e){document.getElementById("exportTableToExcelDef")?.remove();const t=this.exportDivToTable(e);if(!t)return;const s=document.createElement("div");s.innerHTML=t,s.style.display="none",s.id="exportTableToExcelDef",document.body.appendChild(s),this.exportTableToExcel("exportTableToExcelDef",e)}exportDivToTable(e){const t=document.getElementById(e);if(!t)return;let s="<table>";for(let e=0;e<t.children.length;e++){s+="<tr>";const n=t.children[e];for(let e=0;e<n.children.length;e++)s+="<td>",s+=n.children[e].innerHTML,s+="</td>";s+="</tr>"}return s+="</table>",s}exportTableToExcel(e,t=""){const s="application/vnd.ms-excel",n=document.getElementById(e);if(!n)return;const d=n.outerHTML.replace(/ /g,"%20");t=t?t+".xls":"excel_data.xls";const i=document.createElement("a");if(document.body.appendChild(i),navigator.msSaveOrOpenBlob){const e=new Blob(["\ufeff",d],{type:s});navigator.msSaveOrOpenBlob(e,t)}else i.href="data:"+s+", "+d,i.download=t,i.click()}}).init()}();
//# sourceMappingURL=w40k.js.map