<!DOCTYPE html>
<html lang="en">
<!-- https://developer.snapappointments.com/bootstrap-select/ -->

<head>
  <!--<link rel="preconnect" href="https://fonts.gstatic.com">-->
  <!--<link rel="preload" href="https://fonts.gstatic.com/s/breeserif/v17/4UaHrEJCrhhnVA3DgluA96Tp56N1.woff2" as="font" type="font/woff2" crossorigin>-->
  <!--<link rel="preload" href="https://fonts.gstatic.com/s/breeserif/v17/4UaHrEJCrhhnVA3DgluA96rp5w.woff2" as="font" type="font/woff2" crossorigin>-->
  <!--<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>-->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>valheim-food</title>
  <meta http-equiv="Cache-Control" content="must-revalidate, max-age=86400" />
  <!--<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />-->
  <!--<link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">-->
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <!--<link href="https://fonts.googleapis.com/css2?family=Bree+Serif&display=swap" rel="stylesheet">-->
  <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <!--<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">-->
  <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />-->
  <!--<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/css/bootstrap-slider.min.css" integrity="sha512-3q8fi8M0VS+X/3n64Ndpp6Bit7oXSiyCnzmlx6IDBLGlY5euFySyJ46RUlqIVs0DPCGOypqP8IRk/EyPvU28mQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />-->
  <!--<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css">-->
  <link href="tabulator/css/tabulator.min.css" rel="stylesheet">
  <link href="tabulator/css/tabulator_bootstrap4.min.css" rel="stylesheet">
</head>

<!-- ============================================================================================================ -->
<!-- ============================================================================================================ -->

<body style="margin: 1em">

  <a href="https://valheim.fandom.com/wiki/Food" target="_blank">Wiki</a>
  <br><br>

  <div class="no-thead-dark no-table-dark table-striped table-bordered table-sm" id="valheim-food-table"></div>

  <!-- ============================================================================================================ -->
  <!-- ============================================================================================================ -->

  <!--https://developer.snapappointments.com/bootstrap-select/examples/-->
  <script src=" https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
  <!-- <script src="https://cdn.jsdelivr.net/npm/p5@1.4.1/lib/p5.js"></script> -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
		crossorigin="anonymous"></script>-->
  <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>-->
  <!-- https://bootstrap-confirmation.js.org/ -->
  <!-- https://github.com/mistic100/Bootstrap-Confirmation -->
  <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap-confirmation2@4.1.0/dist/bootstrap-confirmation.min.js"></script>-->
  <!-- https://clipboardjs.com/ -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js"></script>-->
  <!-- https://github.com/seiyria/bootstrap-slider -->
  <!-- https://seiyria.com/bootstrap-slider/ -->
  <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/11.0.2/bootstrap-slider.min.js" integrity="sha512-f0VlzJbcEB6KiW8ZVtL+5HWPDyW1+nJEjguZ5IVnSQkvZbwBt2RfCBY0CBO1PsMAqxxrG4Di6TfsCPP3ZRwKpA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>-->
  <!-- https://developer.snapappointments.com/bootstrap-select/ -->
  <!-- https://github.com/snapappointments/bootstrap-select/ -->
  <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>-->
  <!--<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/i18n/defaults-*.min.js"></script>-->

  <!--<script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.4.3/dist/js/tabulator.min.js"></script>-->
  <script type="text/javascript" src="tabulator/js/tabulator.js"></script>
  <script type="text/javascript" src="tabulator/js/FrozenColumns/FrozenColumns.js"></script>
  <script type="text/javascript" src="tabulator/js/Filter/Filter.js"></script>
  <script>
    Tabulator.registerModule([FrozenColumns, Filter]);
  </script>

  <style>
    .tabulator .tabulator-header .tabulator-col .tabulator-col-content .tabulator-col-title {
      white-space: normal;
    }
  </style>

  <!--https://tabulator.info/docs/5.4/quickstart-->
  <!--https://tabulator.info/examples/5.4-->
  <script>
    function app(data) {
      window.localStorage.setItem('valheim-food', JSON.stringify(data));
      console.log(data);
      var tabledata = [];
      for (let [name, food] of Object.entries(data.food)) {
        var row = {
          id: food.id,
          name: food.name,
          tier: food.tier,
          starred: food.starred,// ? 'â˜…' : '',
          hp: food.hp,
          stamina: food.stamina,
          eitr: food.eitr,
          type: food.type.replace("white", "W").replace("yellow", "Y").replace("red", "R").replace("blue", "B"),
          hpPerSecond: food.hpPerSecond,
          durationInMinutes: food.durationInMinutes
        };
        for (let resource of data.resources) {
          if (food.resources[resource]) {
            row[resource] = food.resources[resource];
          } else {
            row[resource] = '';
          }
        }

        tabledata.push(row);
      }
      console.log(tabledata);
      console.table(tabledata);
      var resourceCols = [];
      for (let resource of data.resources) {
        resourceCols.push({ title: resource, field: resource, headerVertical: true, hozAlign: "center" });
      }
      var table = new Tabulator("#valheim-food-table", {
        height: 800, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
        data: tabledata, //assign data to table
        //layout: "fitColumns", //fit columns to width of table (optional)
        //layout: "fitDataTable",
        //layoutColumnsOnNewData: true,
        // responsiveLayout:"hide", // hide rows that no longer fit
        // responsiveLayout:"collapse", // collapse columns that no longer fit on the table into a list under the row
        //resizableRows: true, // this option takes a boolean value (default = false)
        columns: [
          { title: "Name", field: "name", frozen: true, headerFilter: "input" },
          {//create column group
            title: "Info", frozen: true,
            columns: [
              {
                title: "Tier", field: "tier", headerVertical: true, hozAlign: "center", headerFilter: "number", formatter: function (cell, formatterParams) {
                  var value = cell.getValue();
                  if (value == 1) {
                    return "<span style='background-color:#e8f2a1;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else if (value == 2) {
                    return "<span style='background-color:#bbe33d;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else if (value == 3) {
                    return "<span style='background-color:#b4c7dc;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else if (value == 4) {
                    return "<span style='background-color:#b2b2b2;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else if (value == 5) {
                    return "<span style='background-color:#ffdbb6;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else if (value == 6) {
                    return "<span style='background-color:#ff6d6d;display:block;width:100%;height:100%'>" + value + "</span>";
                  } else {
                    return value;
                  }
                }
              },
              { title: "Starred", field: "starred", headerVertical: true, hozAlign: "center", formatter: "tickCross", headerFilter: "tickCross", headerFilterParams: { "tristate": true } },
              { title: "HP", field: "hp", headerVertical: true, hozAlign: "center", headerFilter: "number" },
              { title: "Stamina", field: "stamina", headerVertical: true, hozAlign: "center", headerFilter: "number" },
              { title: "Eitr", field: "eitr", headerVertical: true, hozAlign: "center", headerFilter: "number" },
              {
                title: "Type", field: "type", headerVertical: true, hozAlign: "center", headerFilter: "list", headerFilterParams: { valuesLookup: true, clearable: true }, formatter: function (cell, formatterParams) {
                  var value = cell.getValue();
                  if (value == "Y") {
                    return "<span style='background-color:#ffff84;display:block;width:100%;height:100%'>Y</span>";
                  } else if (value == "R") {
                    return "<span style='background-color:#ff6d6d;display:block;width:100%;height:100%'>R</span>";
                  } else if (value == "B") {
                    return "<span style='background-color:#8787dc;display:block;width:100%;height:100%'>B</span>";
                  } else if (value == "W") {
                    return "<span style='background-color:#ddd;display:block;width:100%;height:100%'>W</span>";
                  } else {
                    return value;
                  }
                }
              },
              { title: "HP/s", field: "hpPerSecond", headerVertical: true, hozAlign: "center", headerFilter: "number" },
              { title: "Duration (m)", field: "durationInMinutes", headerVertical: true, hozAlign: "center", headerFilter: "number" }
            ]
          },
          {//create column group
            title: "Resources",
            columns: resourceCols
          }
        ],
      });
    }
    // https://developer.mozilla.org/en-US/docs/Web/API/Response/json
    // https://blog.logrocket.com/storing-retrieving-javascript-objects-localstorage/
    (() => {
      try {
        let valheimFood = window.localStorage.getItem('valheim-food');
        if (valheimFood && valheimFood != undefined && valheimFood != null) {
          let data = JSON.parse(valheimFood);
          console.log(data.headers);
          app(data);
        } else {
          fetch('valheim-food.json')
            .then((response) => response.json())
            .then((data) => app(data));
        }
      } catch (e) {
        console.log(e);
        fetch('valheim-food.json')
          .then((response) => response.json())
          .then((data) => app(data));
      }
    })();
  </script>

</body>

</html>